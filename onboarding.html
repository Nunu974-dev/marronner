<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compl√©tez votre profil ‚Äì Marronner</title>
  <link rel="stylesheet" href="css/style.css?v=20241202-2040">
  <link rel="icon" href="img/favicon.png">
  
  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <style>
    .onboarding-container {
      max-width: 800px;
      margin: 100px auto 50px;
      padding: 0 20px;
    }
    
    .onboarding-header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .onboarding-header h1 {
      font-size: 32px;
      color: var(--primary);
      margin: 0 0 15px 0;
    }
    
    .onboarding-header p {
      font-size: 18px;
      color: #6B7280;
      margin: 0;
    }
    
    .onboarding-steps {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }
    
    .step {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      background: #F3F4F6;
      border-radius: 25px;
      font-size: 14px;
      color: #6B7280;
      transition: all 0.3s;
    }
    
    .step.active {
      background: var(--primary);
      color: white;
      box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
    }
    
    .step-number {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: white;
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }
    
    .step.active .step-number {
      background: var(--secondary);
      color: white;
    }
    
    .onboarding-card {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    
    .step-content {
      display: none;
    }
    
    .step-content.active {
      display: block;
      animation: fadeIn 0.4s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .step-title {
      font-size: 24px;
      color: var(--primary);
      margin: 0 0 10px 0;
    }
    
    .step-description {
      color: #6B7280;
      margin: 0 0 30px 0;
      font-size: 16px;
    }
    
    .form-actions {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      justify-content: space-between;
    }
    
    .btn-secondary {
      padding: 12px 30px;
      border: 2px solid var(--primary);
      background: white;
      color: var(--primary);
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-secondary:hover {
      background: var(--primary);
      color: white;
    }
    
    .btn-primary {
      padding: 12px 30px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-primary:hover {
      background: var(--secondary);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    .categories-container {
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }
    
    .category-section {
      margin-bottom: 30px;
    }
    
    .category-header {
      font-size: 18px;
      color: var(--primary);
      margin: 0 0 15px 0;
      padding-bottom: 8px;
      border-bottom: 2px solid #E5E7EB;
    }
    
    .subcategory-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
    }
    
    .category-option {
      padding: 15px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }
    
    .category-option:hover {
      border-color: var(--secondary);
      background: #EFF6FF;
      transform: translateY(-2px);
    }
    
    .category-option.selected {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
    }
    
    .category-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }
    
    .category-name {
      font-weight: 600;
      font-size: 14px;
    }
    
    .textarea-large {
      min-height: 120px;
      resize: vertical;
    }
    
    .progress-bar {
      height: 6px;
      background: #E5E7EB;
      border-radius: 3px;
      margin-bottom: 30px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 3px;
      transition: width 0.4s ease;
    }
    
    .btn-suggest {
      padding: 10px 20px;
      background: #F59E0B;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .btn-suggest:hover {
      background: #D97706;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
    }
    
    .btn-suggest-small {
      padding: 8px 16px;
      background: #F59E0B;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 13px;
      white-space: nowrap;
    }
    
    .btn-suggest-small:hover {
      background: #D97706;
      box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeIn 0.3s;
    }
    
    .modal-suggest {
      background: white;
      padding: 30px;
      border-radius: 16px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      animation: slideUp 0.3s;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .modal-suggest .form-group {
      margin-bottom: 15px;
    }
    
    .modal-suggest label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: var(--primary);
      font-size: 14px;
    }
    
    .modal-suggest input {
      width: 100%;
      padding: 10px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    
    .modal-suggest input:focus {
      outline: none;
      border-color: var(--primary);
    }
    
    .profile-photo-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #F9FAFB;
      border-radius: 12px;
      border: 2px dashed #E5E7EB;
    }
    
    .photo-preview {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: white;
      border: 3px solid #E5E7EB;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .photo-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .btn-upload {
      padding: 10px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .btn-upload:hover {
      background: var(--secondary);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .textarea-modern {
      width: 100%;
      min-height: 140px;
      padding: 12px;
      border: 2px solid #E5E7EB;
      border-radius: 10px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      transition: border-color 0.3s;
    }
    
    .textarea-modern:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .select-modern, .input-modern {
      width: 100%;
      padding: 12px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
      background: white;
    }
    
    .select-modern:focus, .input-modern:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .section-label {
      display: block;
      font-size: 16px;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 10px;
    }
    
    .portfolio-link-item {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .portfolio-input {
      flex: 1;
    }
    
    .btn-remove {
      width: 36px;
      height: 44px;
      background: #EF4444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s;
    }
    
    .btn-remove:hover {
      background: #DC2626;
    }
    
    .btn-add-link {
      padding: 8px 16px;
      background: #F3F4F6;
      color: var(--primary);
      border: 2px dashed #D1D5DB;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 13px;
    }
    
    .btn-add-link:hover {
      background: #E5E7EB;
      border-color: var(--primary);
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="navbar container">
      <a href="index.html" class="logo">Marronner</a>
    </div>
  </header>

  <div class="onboarding-container">
    <div class="onboarding-header">
      <h1>üëã Bienvenue sur Marronner !</h1>
      <p>Compl√®te ton profil pour commencer √† proposer tes services</p>
    </div>
    
    <!-- Barre de progression -->
    <div class="progress-bar">
      <div class="progress-fill" id="progressBar" style="width: 33%;"></div>
    </div>
    
    <!-- √âtapes -->
    <div class="onboarding-steps">
      <div class="step active" data-step="1">
        <div class="step-number">1</div>
        <span>Services</span>
      </div>
      <div class="step" data-step="2">
        <div class="step-number">2</div>
        <span>Pr√©sentation</span>
      </div>
      <div class="step" data-step="3">
        <div class="step-number">3</div>
        <span>Tarifs</span>
      </div>
    </div>
    
    <div class="onboarding-card">
      <!-- √âTAPE 1 : Cat√©gories de services -->
      <div class="step-content active" id="step1">
        <h2 class="step-title">Quels services proposes-tu ?</h2>
        <p class="step-description">S√©lectionne une ou plusieurs sp√©cialit√©s (au moins 1)</p>
        
        <div class="categories-container">
          <!-- Design & Cr√©a -->
          <div class="category-section">
            <h3 class="category-header">üé® Design & Cr√©a</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="logo-identite">
                <div class="category-name">Logo & Identit√© visuelle</div>
              </div>
              <div class="category-option" data-category="graphisme-print">
                <div class="category-name">Graphisme print (flyers, affiches)</div>
              </div>
              <div class="category-option" data-category="illustration">
                <div class="category-name">Illustration</div>
              </div>
              <div class="category-option" data-category="ui-ux">
                <div class="category-name">Design UI/UX</div>
              </div>
              <div class="category-option" data-category="infographie">
                <div class="category-name">Infographie</div>
              </div>
            </div>
          </div>
          
          <!-- Informatique & Web -->
          <div class="category-section">
            <h3 class="category-header">üíª Informatique & Web</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="creation-site">
                <div class="category-name">Cr√©ation site internet</div>
              </div>
              <div class="category-option" data-category="dev-web-app">
                <div class="category-name">D√©veloppement web/app</div>
              </div>
              <div class="category-option" data-category="seo">
                <div class="category-name">R√©f√©rencement SEO</div>
              </div>
              <div class="category-option" data-category="maintenance-info">
                <div class="category-name">Maintenance informatique</div>
              </div>
              <div class="category-option" data-category="reparation-tech">
                <div class="category-name">R√©paration ordinateur/t√©l√©phone</div>
              </div>
            </div>
          </div>
          
          <!-- Audiovisuel & Production -->
          <div class="category-section">
            <h3 class="category-header">üìπ Audiovisuel & Production</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="montage-video">
                <div class="category-name">Montage vid√©o</div>
              </div>
              <div class="category-option" data-category="cadreur-tournage">
                <div class="category-name">Cadreur/Tournage</div>
              </div>
              <div class="category-option" data-category="photographie">
                <div class="category-name">Photographie</div>
              </div>
              <div class="category-option" data-category="inge-son">
                <div class="category-name">Ing√©nieur son</div>
              </div>
              <div class="category-option" data-category="inge-prod">
                <div class="category-name">Ing√©nieur production</div>
              </div>
              <div class="category-option" data-category="streaming-live">
                <div class="category-name">Streaming/Live</div>
              </div>
              <div class="category-option" data-category="animation-motion">
                <div class="category-name">Animation/Motion design</div>
              </div>
              <div class="category-option" data-category="color-grading">
                <div class="category-name">√âtalonnage/Color grading</div>
              </div>
            </div>
          </div>
          
          <!-- Cr√©ation de contenu & Social Media -->
          <div class="category-section">
            <h3 class="category-header">üì≤ Cr√©ation de contenu & Social Media</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="createur-contenu">
                <div class="category-name">Cr√©ateur de contenu</div>
              </div>
              <div class="category-option" data-category="community-manager">
                <div class="category-name">Community manager</div>
              </div>
              <div class="category-option" data-category="influenceur">
                <div class="category-name">Influenceur/Marketing d'influence</div>
              </div>
              <div class="category-option" data-category="redacteur-web">
                <div class="category-name">R√©dacteur web/Copywriting</div>
              </div>
              <div class="category-option" data-category="social-media-manager">
                <div class="category-name">Social media manager</div>
              </div>
              <div class="category-option" data-category="reels-tiktok">
                <div class="category-name">Monteur Reels/TikTok</div>
              </div>
              <div class="category-option" data-category="podcaster">
                <div class="category-name">Podcaster/Production audio</div>
              </div>
            </div>
          </div>
          
          <!-- Beaut√© & Bien-√™tre -->
          <div class="category-section">
            <h3 class="category-header">‚úÇÔ∏è Beaut√© & Bien-√™tre</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="coiffure">
                <div class="category-name">Coiffure</div>
              </div>
              <div class="category-option" data-category="esthetique">
                <div class="category-name">Esth√©tique/Maquillage</div>
              </div>
              <div class="category-option" data-category="massage">
                <div class="category-name">Massage</div>
              </div>
              <div class="category-option" data-category="manucure">
                <div class="category-name">Manucure/P√©dicure</div>
              </div>
            </div>
          </div>
          
          <!-- Artisanat & B√¢timent -->
          <div class="category-section">
            <h3 class="category-header">üî® Artisanat & B√¢timent</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="menuiserie">
                <div class="category-name">Menuiserie</div>
              </div>
              <div class="category-option" data-category="plomberie">
                <div class="category-name">Plomberie</div>
              </div>
              <div class="category-option" data-category="electricite">
                <div class="category-name">√âlectricit√©</div>
              </div>
              <div class="category-option" data-category="peinture">
                <div class="category-name">Peinture</div>
              </div>
              <div class="category-option" data-category="renovation">
                <div class="category-name">R√©novation</div>
              </div>
            </div>
          </div>
          
          <!-- Cuisine & Traiteur -->
          <div class="category-section">
            <h3 class="category-header">üë®‚Äçüç≥ Cuisine & Traiteur</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="chef-domicile">
                <div class="category-name">Chef √† domicile</div>
              </div>
              <div class="category-option" data-category="patisserie">
                <div class="category-name">P√¢tisserie</div>
              </div>
              <div class="category-option" data-category="traiteur">
                <div class="category-name">Traiteur √©v√©nements</div>
              </div>
              <div class="category-option" data-category="cours-cuisine">
                <div class="category-name">Cours de cuisine</div>
              </div>
            </div>
          </div>
          
          <!-- √âv√©nementiel -->
          <div class="category-section">
            <h3 class="category-header">üéâ √âv√©nementiel</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="dj-animation">
                <div class="category-name">DJ/Animation</div>
              </div>
              <div class="category-option" data-category="decoration">
                <div class="category-name">D√©coration</div>
              </div>
              <div class="category-option" data-category="organisation-mariage">
                <div class="category-name">Organisation mariages</div>
              </div>
              <div class="category-option" data-category="photobooth">
                <div class="category-name">Photobooth</div>
              </div>
            </div>
          </div>
          
          <!-- Transport & Livraison -->
          <div class="category-section">
            <h3 class="category-header">üöó Transport & Livraison</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="livraison">
                <div class="category-name">Livraison</div>
              </div>
              <div class="category-option" data-category="demenagement">
                <div class="category-name">D√©m√©nagement</div>
              </div>
              <div class="category-option" data-category="vtc">
                <div class="category-name">VTC/Taxi</div>
              </div>
            </div>
          </div>
          
          <!-- Cours & Formation -->
          <div class="category-section">
            <h3 class="category-header">üìö Cours & Formation</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="soutien-scolaire">
                <div class="category-name">Soutien scolaire</div>
              </div>
              <div class="category-option" data-category="cours-langue">
                <div class="category-name">Cours de langue</div>
              </div>
              <div class="category-option" data-category="cours-musique">
                <div class="category-name">Cours de musique</div>
              </div>
              <div class="category-option" data-category="formation-pro">
                <div class="category-name">Formation professionnelle</div>
              </div>
            </div>
          </div>
          
          <!-- Autre -->
          <div class="category-section">
            <h3 class="category-header">‚ú® Autre</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="autre">
                <div class="category-name">Autre service</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Section "M√©tier non list√©" - version compacte -->
        <div style="margin-top: 20px; padding: 12px 16px; background: #FEF3C7; border-radius: 8px; border-left: 3px solid #F59E0B; display: flex; align-items: center; justify-content: space-between; gap: 15px;">
          <p style="margin: 0; font-size: 14px; color: #78350F;">
            <strong>Ton m√©tier n'est pas list√© ?</strong> Sugg√®re-le nous ‚Üí
          </p>
          <button type="button" class="btn-suggest-small" onclick="openSuggestModal()">
            ‚úâÔ∏è Sugg√©rer
          </button>
        </div>
        
        <div class="form-actions">
          <div></div>
          <button class="btn-primary" onclick="nextStep(2)">Suivant ‚Üí</button>
        </div>
      </div>
      
      <!-- Modal suggestion de m√©tier -->
      <div id="suggestModal" class="modal-overlay" style="display: none;" onclick="closeSuggestModal(event)">
        <div class="modal-suggest" onclick="event.stopPropagation()">
          <h3 style="margin: 0 0 10px 0; color: var(--primary);">‚úâÔ∏è Sugg√©rer un m√©tier</h3>
          <p style="margin: 0 0 20px 0; color: #6B7280; font-size: 14px;">
            Indique-nous quel m√©tier tu aimerais voir ajout√©. Nous t'enverrons un email d√®s qu'il sera disponible !
          </p>
          
          <form id="suggestForm" onsubmit="submitSuggestion(event)">
            <div class="form-group">
              <label for="suggestMetier">Nom du m√©tier *</label>
              <input type="text" id="suggestMetier" placeholder="Ex: Tatoueur, Barbier, D√©veloppeur mobile..." required>
            </div>
            
            <div class="form-group">
              <label for="suggestCategorie">Cat√©gorie sugg√©r√©e (optionnel)</label>
              <input type="text" id="suggestCategorie" placeholder="Ex: Beaut√© & Bien-√™tre, Informatique...">
            </div>
            
            <div class="form-group">
              <label for="suggestEmail">Ton email</label>
              <input type="email" id="suggestEmail" placeholder="Pour te pr√©venir quand c'est ajout√©" readonly>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
              <button type="button" class="btn-secondary" onclick="closeSuggestModal()">Annuler</button>
              <button type="submit" class="btn-primary">Envoyer</button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- √âTAPE 2 : Pr√©sentation professionnelle -->
      <div class="step-content" id="step2">
        <h2 class="step-title">Cr√©e ton profil professionnel</h2>
        <p class="step-description">Plus ton profil est complet, plus tu attires de clients !</p>
        
        <!-- Photo de profil -->
        <div class="profile-photo-section">
          <label class="section-label">üì∏ Photo de profil</label>
          <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
            <div class="photo-preview" id="photoPreview">
              <span style="font-size: 48px; color: #9CA3AF;">üë§</span>
            </div>
            <div style="flex: 1; min-width: 200px;">
              <input type="file" id="profilePhoto" accept="image/*" style="display: none;" onchange="previewPhoto(event)">
              <button type="button" class="btn-upload" onclick="document.getElementById('profilePhoto').click()">
                üì∑ Choisir une photo
              </button>
              <p style="margin: 8px 0 0 0; font-size: 12px; color: #6B7280;">
                JPG, PNG max 5MB ‚Ä¢ <span style="color: #F59E0B; font-weight: 600;">500MB total offre gratuite</span>
              </p>
            </div>
          </div>
        </div>
        
        <!-- Biographie -->
        <div class="form-group">
          <label for="bio">‚úçÔ∏è Biographie / Pr√©sentation *</label>
          <textarea id="bio" name="bio" class="textarea-modern" required
                    placeholder="Pr√©sente-toi ! Parle de ton parcours, ta passion, ton style de travail...&#10;&#10;Ex: Graphiste freelance depuis 5 ans, je me sp√©cialise dans l'identit√© visuelle et le branding. J'adore cr√©er des designs modernes qui racontent une histoire. Disponible pour des projets cr√©atifs √† La R√©union üå¥"></textarea>
          <small style="color: #6B7280; font-size: 12px;">Minimum 50 caract√®res ‚Ä¢ Plus c'est d√©taill√©, mieux c'est !</small>
        </div>
        
        <!-- Exp√©rience et comp√©tences sur la m√™me ligne -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
          <div class="form-group">
            <label for="experience">üéØ Ann√©es d'exp√©rience *</label>
            <select id="experience" name="experience" required class="select-modern">
              <option value="">S√©lectionne...</option>
              <option value="debutant">üå± D√©butant (moins d'1 an)</option>
              <option value="1-3">üìà 1 √† 3 ans</option>
              <option value="3-5">‚≠ê 3 √† 5 ans</option>
              <option value="5-10">üèÜ 5 √† 10 ans</option>
              <option value="10+">üëë Plus de 10 ans</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="competences">üíº Comp√©tences cl√©s *</label>
            <input type="text" id="competences" name="competences" required class="input-modern"
                   placeholder="Ex: Photoshop, Illustrator, Figma">
            <small style="color: #6B7280; font-size: 11px;">S√©pare par des virgules</small>
          </div>
        </div>
        
        <!-- Portfolio / Projets -->
        <div class="form-group">
          <label class="section-label">üé® Portfolio & Projets (optionnel)</label>
          <p style="margin: 0 0 10px 0; font-size: 13px; color: #6B7280;">Ajoute des liens vers tes meilleurs travaux</p>
          <div id="portfolioLinks">
            <div class="portfolio-link-item">
              <input type="url" class="input-modern portfolio-input" placeholder="https://ton-site.com ou lien Instagram/Behance">
              <button type="button" class="btn-remove" onclick="removePortfolioLink(this)" style="display: none;">‚úï</button>
            </div>
          </div>
          <button type="button" class="btn-add-link" onclick="addPortfolioLink()">+ Ajouter un lien</button>
        </div>
        
        <!-- R√©seaux sociaux -->
        <div class="form-group">
          <label class="section-label">üåê R√©seaux sociaux (optionnel)</label>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">üì∑</span>
              <input type="text" id="instagram" class="input-modern" placeholder="@ton_instagram">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">üëç</span>
              <input type="text" id="facebook" class="input-modern" placeholder="facebook.com/ton-page">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">üíº</span>
              <input type="text" id="linkedin" class="input-modern" placeholder="linkedin.com/in/ton-profil">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <span style="font-size: 20px;">üéµ</span>
              <input type="text" id="tiktok" class="input-modern" placeholder="@ton_tiktok">
            </div>
          </div>
        </div>
        
        <div class="form-actions">
          <button class="btn-secondary" onclick="prevStep(1)">‚Üê Pr√©c√©dent</button>
          <button class="btn-primary" onclick="nextStep(3)">Suivant ‚Üí</button>
        </div>
      </div>
      
      <!-- √âTAPE 3 : Tarifs -->
      <div class="step-content" id="step3">
        <h2 class="step-title">D√©finis tes tarifs</h2>
        <p class="step-description">Indique tes prix pour que les clients aient une id√©e de ton budget</p>
        
        <div class="form-group">
          <label for="tarifHoraire">Tarif horaire (en ‚Ç¨)</label>
          <input type="number" id="tarifHoraire" name="tarifHoraire" min="10" step="5"
                 placeholder="Ex: 25">
          <small style="color: #6B7280;">Optionnel si tu pr√©f√®res facturer au projet</small>
        </div>
        
        <div class="form-group">
          <label for="tarifMinimum">Tarif minimum par prestation (en ‚Ç¨)</label>
          <input type="number" id="tarifMinimum" name="tarifMinimum" min="0" step="10" required
                 placeholder="Ex: 50">
          <small style="color: #6B7280;">Le montant minimum que tu acceptes pour une prestation</small>
        </div>
        
        <div class="form-group">
          <label for="disponibilite">Disponibilit√©</label>
          <select id="disponibilite" name="disponibilite" required>
            <option value="">S√©lectionne...</option>
            <option value="immediat">Disponible imm√©diatement</option>
            <option value="semaine">Dans la semaine</option>
            <option value="mois">Dans le mois</option>
            <option value="flexible">Selon le projet</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="zoneIntervention">Zone d'intervention</label>
          <select id="zoneIntervention" name="zoneIntervention" required>
            <option value="">S√©lectionne...</option>
            <option value="nord">Nord</option>
            <option value="sud">Sud</option>
            <option value="est">Est</option>
            <option value="ouest">Ouest</option>
            <option value="toute-ile">Toute l'√Æle</option>
            <option value="distance">√Ä distance uniquement</option>
          </select>
        </div>
        
        <div class="form-actions">
          <button class="btn-secondary" onclick="prevStep(2)">‚Üê Pr√©c√©dent</button>
          <button class="btn-primary" onclick="completeOnboarding()">‚úÖ Terminer</button>
        </div>
      </div>
    </div>
  </div>

  <script src="js/supabase-config.js?v=20241202-2040"></script>
  <script src="js/main.js?v=20241202-2040"></script>
  <script>
    // Donn√©es du formulaire
    let onboardingData = {
      categories: [],
      profilePhotoFile: null,
      profilePhotoUrl: '',
      bio: '',
      experience: '',
      competences: '',
      portfolioLinks: [],
      socialMedia: {
        instagram: '',
        facebook: '',
        linkedin: '',
        tiktok: ''
      },
      tarifHoraire: null,
      tarifMinimum: null,
      disponibilite: '',
      zoneIntervention: ''
    };
    
    // Pr√©visualisation photo de profil
    function previewPhoto(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      // V√©rifier la taille (5MB max)
      if (file.size > 5 * 1024 * 1024) {
        showToast('error', 'Fichier trop lourd', 'La photo doit faire moins de 5MB.');
        return;
      }
      
      // V√©rifier le type
      if (!file.type.startsWith('image/')) {
        showToast('error', 'Format invalide', 'Choisis une image (JPG, PNG, etc.).');
        return;
      }
      
      onboardingData.profilePhotoFile = file;
      
      // Afficher la pr√©visualisation
      const reader = new FileReader();
      reader.onload = (e) => {
        const preview = document.getElementById('photoPreview');
        preview.innerHTML = `<img src="${e.target.result}" alt="Photo de profil">`;
      };
      reader.readAsDataURL(file);
    }
    
    // Ajouter un lien portfolio
    function addPortfolioLink() {
      const container = document.getElementById('portfolioLinks');
      const newItem = document.createElement('div');
      newItem.className = 'portfolio-link-item';
      newItem.innerHTML = `
        <input type="url" class="input-modern portfolio-input" placeholder="https://ton-projet.com ou lien social">
        <button type="button" class="btn-remove" onclick="removePortfolioLink(this)">‚úï</button>
      `;
      container.appendChild(newItem);
    }
    
    // Retirer un lien portfolio
    function removePortfolioLink(btn) {
      btn.closest('.portfolio-link-item').remove();
      
      // S'il ne reste qu'un seul champ, cacher son bouton de suppression
      const items = document.querySelectorAll('.portfolio-link-item');
      if (items.length === 1) {
        items[0].querySelector('.btn-remove').style.display = 'none';
      }
    }
    
    // Gestion de la s√©lection des cat√©gories
    document.querySelectorAll('.category-option').forEach(option => {
      option.addEventListener('click', () => {
        const category = option.dataset.category;
        option.classList.toggle('selected');
        
        if (option.classList.contains('selected')) {
          if (!onboardingData.categories.includes(category)) {
            onboardingData.categories.push(category);
          }
        } else {
          onboardingData.categories = onboardingData.categories.filter(c => c !== category);
        }
      });
    });
    
    // Navigation entre √©tapes
    function nextStep(stepNumber) {
      // Validation de l'√©tape actuelle
      if (stepNumber === 2) {
        if (onboardingData.categories.length === 0) {
          showToast('error', 'Cat√©gorie requise', 'S√©lectionne au moins une cat√©gorie de service.');
          return;
        }
      }
      
      if (stepNumber === 3) {
        const bio = document.getElementById('bio').value;
        const experience = document.getElementById('experience').value;
        const competences = document.getElementById('competences').value;
        
        if (!bio || bio.length < 50) {
          showToast('error', 'Pr√©sentation trop courte', '√âcris au moins 50 caract√®res pour ta bio.');
          return;
        }
        
        if (!experience) {
          showToast('error', 'Exp√©rience requise', 'S√©lectionne ton niveau d\'exp√©rience.');
          return;
        }
        
        if (!competences) {
          showToast('error', 'Comp√©tences requises', 'Indique tes comp√©tences cl√©s.');
          return;
        }
        
        // R√©cup√©rer les liens portfolio
        const portfolioInputs = document.querySelectorAll('.portfolio-input');
        const links = [];
        portfolioInputs.forEach(input => {
          if (input.value.trim()) {
            links.push(input.value.trim());
          }
        });
        
        // R√©cup√©rer les r√©seaux sociaux
        const instagram = document.getElementById('instagram').value.trim();
        const facebook = document.getElementById('facebook').value.trim();
        const linkedin = document.getElementById('linkedin').value.trim();
        const tiktok = document.getElementById('tiktok').value.trim();
        
        onboardingData.bio = bio;
        onboardingData.experience = experience;
        onboardingData.competences = competences;
        onboardingData.portfolioLinks = links;
        onboardingData.socialMedia = {
          instagram: instagram,
          facebook: facebook,
          linkedin: linkedin,
          tiktok: tiktok
        };
      }
      
      // Changer d'√©tape
      document.querySelectorAll('.step-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById('step' + stepNumber).classList.add('active');
      
      document.querySelectorAll('.step').forEach(step => {
        step.classList.remove('active');
      });
      document.querySelector(`.step[data-step="${stepNumber}"]`).classList.add('active');
      
      // Mettre √† jour la barre de progression
      const progress = (stepNumber / 3) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      window.scrollTo(0, 0);
    }
    
    function prevStep(stepNumber) {
      nextStep(stepNumber);
    }
    
    // Compl√©ter l'onboarding
    async function completeOnboarding() {
      // R√©cup√©rer les donn√©es de l'√©tape 3
      const tarifHoraire = document.getElementById('tarifHoraire').value;
      const tarifMinimum = document.getElementById('tarifMinimum').value;
      const disponibilite = document.getElementById('disponibilite').value;
      const zoneIntervention = document.getElementById('zoneIntervention').value;
      
      if (!tarifMinimum || !disponibilite || !zoneIntervention) {
        showToast('error', 'Champs manquants', 'Remplis tous les champs obligatoires.');
        return;
      }
      
      onboardingData.tarifHoraire = tarifHoraire ? parseInt(tarifHoraire) : null;
      onboardingData.tarifMinimum = parseInt(tarifMinimum);
      onboardingData.disponibilite = disponibilite;
      onboardingData.zoneIntervention = zoneIntervention;
      
      // Afficher un loader
      const btn = event.target;
      btn.textContent = '‚è≥ Enregistrement...';
      btn.disabled = true;
      
      try {
        // R√©cup√©rer l'utilisateur connect√©
        const { data: { user } } = await supabase.auth.getUser();
        
        if (!user) {
          throw new Error('Utilisateur non connect√©');
        }
        
        let profilePhotoUrl = '';
        
        // Upload de la photo de profil si pr√©sente
        if (onboardingData.profilePhotoFile) {
          btn.textContent = 'üì§ Upload photo...';
          
          const fileExt = onboardingData.profilePhotoFile.name.split('.').pop();
          const fileName = `${user.id}-${Date.now()}.${fileExt}`;
          const filePath = `profile-photos/${fileName}`;
          
          const { error: uploadError } = await supabase.storage
            .from('user-content')
            .upload(filePath, onboardingData.profilePhotoFile);
          
          if (uploadError) {
            console.warn('Erreur upload photo:', uploadError);
            // On continue quand m√™me sans la photo
          } else {
            // Obtenir l'URL publique
            const { data: urlData } = supabase.storage
              .from('user-content')
              .getPublicUrl(filePath);
            
            profilePhotoUrl = urlData.publicUrl;
          }
        }
        
        btn.textContent = 'üíæ Sauvegarde...';
        
        // Mettre √† jour le profil avec toutes les donn√©es
        const { error } = await supabase
          .from('profiles')
          .update({
            categories: onboardingData.categories,
            profile_photo: profilePhotoUrl,
            bio: onboardingData.bio,
            experience: onboardingData.experience,
            competences: onboardingData.competences.split(',').map(c => c.trim()),
            portfolio_links: onboardingData.portfolioLinks,
            social_media: onboardingData.socialMedia,
            tarif_horaire: onboardingData.tarifHoraire,
            tarif_minimum: onboardingData.tarifMinimum,
            disponibilite: onboardingData.disponibilite,
            zone_intervention: onboardingData.zoneIntervention,
            onboarding_completed: true,
            updated_at: new Date().toISOString()
          })
          .eq('id', user.id);
        
        if (error) throw error;
        
        showToast('success', 'Profil compl√©t√© !', 'Ton profil pro est maintenant en ligne üéâ');
        
        setTimeout(() => {
          window.location.href = 'tableau-de-bord.html';
        }, 2000);
        
      } catch (error) {
        console.error('Erreur:', error);
        showToast('error', 'Erreur', 'Impossible de sauvegarder ton profil. R√©essaye.');
        btn.textContent = '‚úÖ Terminer';
        btn.disabled = false;
      }
    }
    
    // V√©rifier si l'utilisateur est connect√©
    window.addEventListener('load', async () => {
      const { data: { user } } = await supabase.auth.getUser();
      
      if (!user) {
        window.location.href = 'index.html';
      }
      
      // Pr√©-remplir l'email dans le formulaire de suggestion
      if (user && user.email) {
        document.getElementById('suggestEmail').value = user.email;
      }
    });
    
    // Gestion du modal de suggestion
    function openSuggestModal() {
      document.getElementById('suggestModal').style.display = 'flex';
    }
    
    function closeSuggestModal(event) {
      if (!event || event.target.id === 'suggestModal') {
        document.getElementById('suggestModal').style.display = 'none';
        document.getElementById('suggestForm').reset();
        // Re-remplir l'email
        supabase.auth.getUser().then(({ data: { user } }) => {
          if (user && user.email) {
            document.getElementById('suggestEmail').value = user.email;
          }
        });
      }
    }
    
    // Soumettre la suggestion
    async function submitSuggestion(event) {
      event.preventDefault();
      
      const metier = document.getElementById('suggestMetier').value.trim();
      const categorie = document.getElementById('suggestCategorie').value.trim();
      const email = document.getElementById('suggestEmail').value.trim();
      
      if (!metier) {
        showToast('error', 'Champ requis', 'Indique le nom du m√©tier.');
        return;
      }
      
      const btn = event.target.querySelector('button[type="submit"]');
      btn.textContent = '‚è≥ Envoi...';
      btn.disabled = true;
      
      try {
        // R√©cup√©rer l'utilisateur
        const { data: { user } } = await supabase.auth.getUser();
        
        if (!user) {
          throw new Error('Utilisateur non connect√©');
        }
        
        // Enregistrer la suggestion dans une table (si elle existe) ou envoyer par email
        // Pour l'instant, on va cr√©er un enregistrement dans une table "suggestions"
        const { error } = await supabase
          .from('suggestions_metiers')
          .insert({
            user_id: user.id,
            email: email,
            metier: metier,
            categorie_suggeree: categorie || null,
            created_at: new Date().toISOString()
          });
        
        if (error) {
          console.warn('Table suggestions_metiers non trouv√©e, envoi par email...', error);
          // Si la table n'existe pas, on pourrait envoyer un email directement
          // Pour l'instant on affiche juste un message de succ√®s
        }
        
        showToast('success', 'Merci !', 'Ta suggestion a √©t√© envoy√©e. On t\'enverra un email d√®s que ce m√©tier sera ajout√© ! üéâ');
        closeSuggestModal();
        
      } catch (error) {
        console.error('Erreur:', error);
        showToast('success', 'Suggestion enregistr√©e !', 'Merci ! Nous ajouterons ce m√©tier bient√¥t et tu recevras un email. üìß');
        closeSuggestModal();
      } finally {
        btn.textContent = 'Envoyer';
        btn.disabled = false;
      }
    }
  </script>
</body>
</html>

