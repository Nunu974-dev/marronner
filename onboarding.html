<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compl√©tez votre profil ‚Äì Marronner</title>
  <link rel="stylesheet" href="css/style.css?v=20241202-2040">
  <link rel="icon" href="img/favicon.png">
  
  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <style>
    .onboarding-container {
      max-width: 800px;
      margin: 100px auto 50px;
      padding: 0 20px;
    }
    
    .onboarding-header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .onboarding-header h1 {
      font-size: 32px;
      color: var(--primary);
      margin: 0 0 15px 0;
    }
    
    .onboarding-header p {
      font-size: 18px;
      color: #6B7280;
      margin: 0;
    }
    
    .onboarding-steps {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }
    
    .step {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      background: #F3F4F6;
      border-radius: 25px;
      font-size: 14px;
      color: #6B7280;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .step:hover {
      background: #E5E7EB;
      transform: translateY(-2px);
    }
    
    .step.active {
      background: var(--primary);
      color: white;
      box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
    }
    
    .step.active:hover {
      background: var(--secondary);
    }
    
    .step-number {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: white;
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
    }
    
    .step.active .step-number {
      background: var(--secondary);
      color: white;
    }
    
    .onboarding-card {
      background: white;
      border-radius: 16px;
      padding: 40px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    
    .step-content {
      display: none;
    }
    
    .step-content.active {
      display: block;
      animation: fadeIn 0.4s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .step-title {
      font-size: 24px;
      color: var(--primary);
      margin: 0 0 10px 0;
    }
    
    .step-description {
      color: #6B7280;
      margin: 0 0 30px 0;
      font-size: 16px;
    }
    
    .form-actions {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      justify-content: space-between;
    }
    
    .btn-secondary {
      padding: 12px 30px;
      border: 2px solid var(--primary);
      background: white;
      color: var(--primary);
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-secondary:hover {
      background: var(--primary);
      color: white;
    }
    
    .btn-primary {
      padding: 12px 30px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-primary:hover {
      background: var(--secondary);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    
    .categories-container {
      max-height: 500px;
      overflow-y: auto;
      padding-right: 10px;
    }
    
    .category-section {
      margin-bottom: 30px;
    }
    
    .category-header {
      font-size: 18px;
      color: var(--primary);
      margin: 0 0 15px 0;
      padding-bottom: 8px;
      border-bottom: 2px solid #E5E7EB;
    }
    
    .subcategory-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 10px;
    }
    
    .category-option {
      padding: 15px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }
    
    .category-option:hover {
      border-color: var(--secondary);
      background: #EFF6FF;
      transform: translateY(-2px);
    }
    
    .category-option.selected {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
    }
    
    .category-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }
    
    .category-name {
      font-weight: 600;
      font-size: 14px;
    }
    
    .textarea-large {
      min-height: 120px;
      resize: vertical;
    }
    
    .progress-bar {
      height: 6px;
      background: #E5E7EB;
      border-radius: 3px;
      margin-bottom: 30px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      border-radius: 3px;
      transition: width 0.4s ease;
    }
    
    .btn-suggest {
      padding: 10px 20px;
      background: #F59E0B;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .btn-suggest:hover {
      background: #D97706;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
    }
    
    .btn-suggest-small {
      padding: 8px 16px;
      background: #F59E0B;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 13px;
      white-space: nowrap;
    }
    
    .btn-suggest-small:hover {
      background: #D97706;
      box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeIn 0.3s;
    }
    
    .modal-suggest {
      background: white;
      padding: 30px;
      border-radius: 16px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      animation: slideUp 0.3s;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .modal-suggest .form-group {
      margin-bottom: 15px;
    }
    
    .modal-suggest label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: var(--primary);
      font-size: 14px;
    }
    
    .modal-suggest input {
      width: 100%;
      padding: 10px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }
    
    .modal-suggest input:focus {
      outline: none;
      border-color: var(--primary);
    }
    
    .profile-photo-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #F9FAFB;
      border-radius: 12px;
      border: 2px dashed #E5E7EB;
    }
    
    .photo-preview {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: white;
      border: 3px solid #E5E7EB;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .photo-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .btn-upload {
      padding: 10px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .btn-upload:hover {
      background: var(--secondary);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }
    
    .textarea-modern {
      width: 100%;
      min-height: 140px;
      padding: 12px;
      border: 2px solid #E5E7EB;
      border-radius: 10px;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      transition: border-color 0.3s;
    }
    
    .textarea-modern:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .select-modern, .input-modern {
      width: 100%;
      padding: 12px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
      background: white;
    }
    
    .select-modern:focus, .input-modern:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .section-label {
      display: block;
      font-size: 16px;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 10px;
    }
    
    .portfolio-link-item {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .portfolio-input {
      flex: 1;
    }
    
    .btn-remove {
      width: 36px;
      height: 44px;
      background: #EF4444;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.2s;
    }
    
    .btn-remove:hover {
      background: #DC2626;
    }
    
    .btn-add-link {
      padding: 8px 16px;
      background: #F3F4F6;
      color: var(--primary);
      border: 2px dashed #D1D5DB;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 13px;
    }
    
    .btn-add-link:hover {
      background: #E5E7EB;
      border-color: var(--primary);
    }
    
    .btn-upload-portfolio {
      padding: 12px 24px;
      background: #10B981;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
    }
    
    .btn-upload-portfolio:hover {
      background: #059669;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }
    
    .btn-tool {
      padding: 8px 16px;
      background: white;
      color: #374151;
      border: 2px solid #E5E7EB;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-tool:hover {
      border-color: var(--primary);
      background: #EFF6FF;
    }
    
    .btn-tool.selected {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }
    
    .btn-add-tool {
      padding: 8px 16px;
      background: #10B981;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      font-size: 13px;
    }
    
    .btn-add-tool:hover {
      background: #059669;
    }
    
    .selected-tool-tag {
      padding: 6px 12px;
      background: var(--primary);
      color: white;
      border-radius: 16px;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    .selected-tool-tag button {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      padding: 0;
    }
    
    .selected-tool-tag button:hover {
      background: rgba(255,255,255,0.3);
    }
    
    /* Premium Offer Styles */
    .premium-mini-banner {
      background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
      border: 2px solid #F59E0B;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 30px;
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .premium-mini-banner:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
      border-color: #D97706;
    }
    
    .premium-badge-mini {
      display: inline-block;
      background: linear-gradient(135deg, #F59E0B, #D97706);
      color: white;
      padding: 4px 12px;
      border-radius: 16px;
      font-weight: 700;
      font-size: 11px;
      letter-spacing: 0.5px;
      white-space: nowrap;
    }
    
    .premium-offer {
      background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
      border: 3px solid #F59E0B;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 40px;
      box-shadow: 0 10px 30px rgba(245, 158, 11, 0.2);
    }
    
    .premium-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .premium-badge {
      display: inline-block;
      background: linear-gradient(135deg, #F59E0B, #D97706);
      color: white;
      padding: 6px 16px;
      border-radius: 20px;
      font-weight: 700;
      font-size: 13px;
      letter-spacing: 0.5px;
    }
    
    .premium-plans {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    @media (max-width: 768px) {
      .premium-plans {
        grid-template-columns: 1fr;
      }
    }
    
    .premium-plan {
      background: white;
      border: 2px solid #E5E7EB;
      border-radius: 12px;
      padding: 24px;
      position: relative;
      transition: all 0.3s;
    }
    
    .premium-plan:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    }
    
    .premium-plan-best {
      border: 3px solid #F59E0B;
      box-shadow: 0 4px 16px rgba(245, 158, 11, 0.3);
    }
    
    .best-deal-badge {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #EF4444, #DC2626);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    .plan-header {
      text-align: center;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 2px dashed #E5E7EB;
    }
    
    .plan-period {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: #6B7280;
      margin-bottom: 10px;
    }
    
    .plan-price {
      display: flex;
      align-items: baseline;
      justify-content: center;
      gap: 4px;
    }
    
    .price-amount {
      font-size: 32px;
      font-weight: 800;
      color: #1F2937;
    }
    
    .price-period {
      font-size: 16px;
      color: #6B7280;
      font-weight: 500;
    }
    
    .plan-saving {
      display: block;
      margin-top: 8px;
      font-size: 12px;
      color: #059669;
      font-weight: 600;
    }
    
    .plan-features {
      list-style: none;
      padding: 0;
      margin: 0 0 20px 0;
    }
    
    .plan-features li {
      padding: 10px 0;
      font-size: 14px;
      color: #374151;
      border-bottom: 1px solid #F3F4F6;
    }
    
    .plan-features li:last-child {
      border-bottom: none;
    }
    
    .btn-select-plan {
      width: 100%;
      padding: 12px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-select-plan:hover {
      background: var(--secondary);
      transform: translateY(-2px);
    }
    
    .btn-select-plan-best {
      background: linear-gradient(135deg, #F59E0B, #D97706);
    }
    
    .btn-select-plan-best:hover {
      background: linear-gradient(135deg, #D97706, #B45309);
    }
    
    .btn-skip-premium {
      width: 100%;
      padding: 12px;
      background: transparent;
      color: #6B7280;
      border: 2px dashed #D1D5DB;
      border-radius: 8px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-skip-premium:hover {
      border-color: #9CA3AF;
      color: #374151;
      background: #F9FAFB;
    }
    
    .premium-plan.selected {
      border-color: #10B981;
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
    }
    
    .premium-plan.selected .btn-select-plan {
      background: #10B981;
    }
    
    .premium-plan.selected::after {
      content: '‚úì S√©lectionn√©';
      position: absolute;
      top: 12px;
      right: 12px;
      background: #10B981;
      color: white;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 700;
    }
    
    /* Premium Modal Finale */
    .premium-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      backdrop-filter: blur(4px);
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .premium-modal-content {
      background: white;
      border-radius: 20px;
      max-width: 900px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      padding: 40px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideUp 0.4s ease;
    }
    
    @keyframes slideUp {
      from {
        transform: translateY(50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .premium-modal-header {
      text-align: center;
      margin-bottom: 35px;
    }
    
    .premium-plan-modal {
      cursor: pointer;
    }
    
    .premium-plan-modal:hover {
      transform: translateY(-6px);
    }
    
    .btn-skip-premium-modal {
      width: 100%;
      padding: 14px;
      margin-top: 20px;
      background: transparent;
      color: #6B7280;
      border: 2px solid #E5E7EB;
      border-radius: 10px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-skip-premium-modal:hover {
      border-color: #9CA3AF;
      color: #374151;
      background: #F9FAFB;
    }
    
    .portfolio-image-preview {
      position: relative;
      aspect-ratio: 1;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid #E5E7EB;
    }
    
    .portfolio-image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .portfolio-image-preview .remove-img {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 24px;
      height: 24px;
      background: #EF4444;
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .checkbox-card {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      border: 2px solid #E5E7EB;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }
    
    .checkbox-card:hover {
      border-color: var(--primary);
      background: #F3F4F6;
    }
    
    .checkbox-card input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }
    
    .checkbox-card input[type="checkbox"]:checked + span {
      font-weight: 600;
      color: var(--primary);
    }
    
    .portfolio-link-item-with-title {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    
    .experience-item {
      padding: 20px;
      background: #F9FAFB;
      border-radius: 12px;
      margin-bottom: 15px;
      border: 2px solid #E5E7EB;
    }
    
    .btn-remove-exp {
      padding: 8px 16px;
      background: #EF4444;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 13px;
    }
    
    .btn-remove-exp:hover {
      background: #DC2626;
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="navbar container">
      <a href="index.html" class="logo">Marronner</a>
      <nav class="menu">
        <a href="demandes.html" style="color: var(--secondary); font-weight: 600;">üìã Voir les demandes</a>
        <a href="tableau-de-bord.html" style="color: #6B7280;">‚è∏Ô∏è Continuer plus tard</a>
      </nav>
    </div>
  </header>

  <div class="onboarding-container">
    <div class="onboarding-header">
      <h1>üëã Bienvenue sur Marronner !</h1>
      <p>Compl√®te ton profil pour commencer √† proposer tes services</p>
      <p style="background: #FEF3C7; padding: 10px 15px; border-radius: 8px; font-size: 14px; color: #92400E; margin-top: 15px;">
        üí° <strong>Tu peux revenir plus tard !</strong> Tes donn√©es sont automatiquement sauvegard√©es.
      </p>
    </div>
    
    <!-- Barre de progression -->
    <div class="progress-bar">
      <div class="progress-fill" id="progressBar" style="width: 25%;"></div>
    </div>
    
    <!-- √âtapes -->
    <div class="onboarding-steps">
      <div class="step active" data-step="1" onclick="goToStep(1)">
        <div class="step-number">1</div>
        <span>Cat√©gories</span>
      </div>
      <div class="step" data-step="2" onclick="goToStep(2)">
        <div class="step-number">2</div>
        <span>Pr√©sentation</span>
      </div>
      <div class="step" data-step="3" onclick="goToStep(3)">
        <div class="step-number">3</div>
        <span>Services</span>
      </div>
      <div class="step" data-step="4" onclick="goToStep(4)">
        <div class="step-number">4</div>
        <span>Tarifs</span>
      </div>
    </div>
    
    <div class="onboarding-card">
      <!-- Mini Banner Premium (visible sur toutes les √©tapes) -->
      <div class="premium-mini-banner" onclick="openPremiumModal()">
        <div style="display: flex; align-items: center; gap: 12px;">
          <span class="premium-badge-mini">‚≠ê PREMIUM</span>
          <div>
            <p style="margin: 0; font-weight: 600; font-size: 14px; color: #1F2937;">Badge v√©rifi√©, 2Go stockage, profil mis en avant...</p>
            <p style="margin: 0; font-size: 12px; color: #6B7280;">√Ä partir de 13,99‚Ç¨/mois ‚Ä¢ Clique pour voir l'offre !</p>
          </div>
        </div>
      </div>
      
      <!-- √âTAPE 1 : Cat√©gories de services -->
      <div class="step-content active" id="step1">
        <h2 class="step-title">Quels services proposes-tu ? *</h2>
        <p class="step-description">S√©lectionne une ou plusieurs sp√©cialit√©s (au moins 1 requis)</p>
        
        <div class="categories-container">
          <!-- Design & Cr√©a -->
          <div class="category-section">
            <h3 class="category-header">üé® Design & Cr√©a</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="logo-identite">
                <div class="category-name">Logo & Identit√© visuelle</div>
              </div>
              <div class="category-option" data-category="graphisme-print">
                <div class="category-name">Graphisme print (flyers, affiches)</div>
              </div>
              <div class="category-option" data-category="illustration">
                <div class="category-name">Illustration</div>
              </div>
              <div class="category-option" data-category="ui-ux">
                <div class="category-name">Design UI/UX</div>
              </div>
              <div class="category-option" data-category="infographie">
                <div class="category-name">Infographie</div>
              </div>
            </div>
          </div>
          
          <!-- Informatique & Web -->
          <div class="category-section">
            <h3 class="category-header">üíª Informatique & Web</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="creation-site">
                <div class="category-name">Cr√©ation site internet</div>
              </div>
              <div class="category-option" data-category="dev-web-app">
                <div class="category-name">D√©veloppement web/app</div>
              </div>
              <div class="category-option" data-category="seo">
                <div class="category-name">R√©f√©rencement SEO</div>
              </div>
              <div class="category-option" data-category="maintenance-info">
                <div class="category-name">Maintenance informatique</div>
              </div>
              <div class="category-option" data-category="reparation-tech">
                <div class="category-name">R√©paration ordinateur/t√©l√©phone</div>
              </div>
            </div>
          </div>
          
          <!-- Audiovisuel & Production -->
          <div class="category-section">
            <h3 class="category-header">üìπ Audiovisuel & Production</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="montage-video">
                <div class="category-name">Montage vid√©o</div>
              </div>
              <div class="category-option" data-category="cadreur-tournage">
                <div class="category-name">Cadreur/Tournage</div>
              </div>
              <div class="category-option" data-category="photographie">
                <div class="category-name">Photographie</div>
              </div>
              <div class="category-option" data-category="inge-son">
                <div class="category-name">Ing√©nieur son</div>
              </div>
              <div class="category-option" data-category="inge-prod">
                <div class="category-name">Ing√©nieur production</div>
              </div>
              <div class="category-option" data-category="streaming-live">
                <div class="category-name">Streaming/Live</div>
              </div>
              <div class="category-option" data-category="animation-motion">
                <div class="category-name">Animation/Motion design</div>
              </div>
              <div class="category-option" data-category="color-grading">
                <div class="category-name">√âtalonnage/Color grading</div>
              </div>
            </div>
          </div>
          
          <!-- Cr√©ation de contenu & Social Media -->
          <div class="category-section">
            <h3 class="category-header">üì≤ Cr√©ation de contenu & Social Media</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="createur-contenu">
                <div class="category-name">Cr√©ateur de contenu</div>
              </div>
              <div class="category-option" data-category="community-manager">
                <div class="category-name">Community manager</div>
              </div>
              <div class="category-option" data-category="influenceur">
                <div class="category-name">Influenceur/Marketing d'influence</div>
              </div>
              <div class="category-option" data-category="redacteur-web">
                <div class="category-name">R√©dacteur web/Copywriting</div>
              </div>
              <div class="category-option" data-category="social-media-manager">
                <div class="category-name">Social media manager</div>
              </div>
              <div class="category-option" data-category="reels-tiktok">
                <div class="category-name">Monteur Reels/TikTok</div>
              </div>
              <div class="category-option" data-category="podcaster">
                <div class="category-name">Podcaster/Production audio</div>
              </div>
            </div>
          </div>
          
          <!-- Beaut√© & Bien-√™tre -->
          <div class="category-section">
            <h3 class="category-header">‚úÇÔ∏è Beaut√© & Bien-√™tre</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="coiffure">
                <div class="category-name">Coiffure</div>
              </div>
              <div class="category-option" data-category="esthetique">
                <div class="category-name">Esth√©tique/Maquillage</div>
              </div>
              <div class="category-option" data-category="massage">
                <div class="category-name">Massage</div>
              </div>
              <div class="category-option" data-category="manucure">
                <div class="category-name">Manucure/P√©dicure</div>
              </div>
            </div>
          </div>
          
          <!-- Artisanat & B√¢timent -->
          <div class="category-section">
            <h3 class="category-header">üî® Artisanat & B√¢timent</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="menuiserie">
                <div class="category-name">Menuiserie</div>
              </div>
              <div class="category-option" data-category="plomberie">
                <div class="category-name">Plomberie</div>
              </div>
              <div class="category-option" data-category="electricite">
                <div class="category-name">√âlectricit√©</div>
              </div>
              <div class="category-option" data-category="peinture">
                <div class="category-name">Peinture</div>
              </div>
              <div class="category-option" data-category="renovation">
                <div class="category-name">R√©novation</div>
              </div>
            </div>
          </div>
          
          <!-- Cuisine & Traiteur -->
          <div class="category-section">
            <h3 class="category-header">üë®‚Äçüç≥ Cuisine & Traiteur</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="chef-domicile">
                <div class="category-name">Chef √† domicile</div>
              </div>
              <div class="category-option" data-category="patisserie">
                <div class="category-name">P√¢tisserie</div>
              </div>
              <div class="category-option" data-category="traiteur">
                <div class="category-name">Traiteur √©v√©nements</div>
              </div>
              <div class="category-option" data-category="cours-cuisine">
                <div class="category-name">Cours de cuisine</div>
              </div>
            </div>
          </div>
          
          <!-- √âv√©nementiel -->
          <div class="category-section">
            <h3 class="category-header">üéâ √âv√©nementiel</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="dj-animation">
                <div class="category-name">DJ/Animation</div>
              </div>
              <div class="category-option" data-category="decoration">
                <div class="category-name">D√©coration</div>
              </div>
              <div class="category-option" data-category="organisation-mariage">
                <div class="category-name">Organisation mariages</div>
              </div>
              <div class="category-option" data-category="photobooth">
                <div class="category-name">Photobooth</div>
              </div>
            </div>
          </div>
          
          <!-- Transport & Livraison -->
          <div class="category-section">
            <h3 class="category-header">üöó Transport & Livraison</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="livraison">
                <div class="category-name">Livraison</div>
              </div>
              <div class="category-option" data-category="demenagement">
                <div class="category-name">D√©m√©nagement</div>
              </div>
              <div class="category-option" data-category="vtc">
                <div class="category-name">VTC/Taxi</div>
              </div>
            </div>
          </div>
          
          <!-- Cours & Formation -->
          <div class="category-section">
            <h3 class="category-header">üìö Cours & Formation</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="soutien-scolaire">
                <div class="category-name">Soutien scolaire</div>
              </div>
              <div class="category-option" data-category="cours-langue">
                <div class="category-name">Cours de langue</div>
              </div>
              <div class="category-option" data-category="cours-musique">
                <div class="category-name">Cours de musique</div>
              </div>
              <div class="category-option" data-category="formation-pro">
                <div class="category-name">Formation professionnelle</div>
              </div>
            </div>
          </div>
          
          <!-- Autre -->
          <div class="category-section">
            <h3 class="category-header">‚ú® Autre</h3>
            <div class="subcategory-grid">
              <div class="category-option" data-category="autre">
                <div class="category-name">Autre service</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Section "M√©tier non list√©" - version compacte -->
        <div style="margin-top: 20px; padding: 12px 16px; background: #FEF3C7; border-radius: 8px; border-left: 3px solid #F59E0B; display: flex; align-items: center; justify-content: space-between; gap: 15px;">
          <p style="margin: 0; font-size: 14px; color: #78350F;">
            <strong>Ton m√©tier n'est pas list√© ?</strong> Sugg√®re-le nous ‚Üí
          </p>
          <button type="button" class="btn-suggest-small" onclick="openSuggestModal()">
            ‚úâÔ∏è Sugg√©rer
          </button>
        </div>
        
        <div class="form-actions">
          <div></div>
          <button class="btn-primary" onclick="nextStep(2)">Suivant ‚Üí</button>
        </div>
      </div>
      
      <!-- Modal suggestion de m√©tier -->
      <div id="suggestModal" class="modal-overlay" style="display: none;" onclick="closeSuggestModal(event)">
        <div class="modal-suggest" onclick="event.stopPropagation()">
          <h3 style="margin: 0 0 10px 0; color: var(--primary);">‚úâÔ∏è Sugg√©rer un m√©tier</h3>
          <p style="margin: 0 0 20px 0; color: #6B7280; font-size: 14px;">
            Indique-nous quel m√©tier tu aimerais voir ajout√©. Nous t'enverrons un email d√®s qu'il sera disponible !
          </p>
          
          <form id="suggestForm" onsubmit="submitSuggestion(event)">
            <div class="form-group">
              <label for="suggestMetier">Nom du m√©tier *</label>
              <input type="text" id="suggestMetier" placeholder="Ex: Tatoueur, Barbier, D√©veloppeur mobile..." required>
            </div>
            
            <div class="form-group">
              <label for="suggestCategorie">Cat√©gorie sugg√©r√©e (optionnel)</label>
              <input type="text" id="suggestCategorie" placeholder="Ex: Beaut√© & Bien-√™tre, Informatique...">
            </div>
            
            <div class="form-group">
              <label for="suggestEmail">Ton email</label>
              <input type="email" id="suggestEmail" placeholder="Pour te pr√©venir quand c'est ajout√©" readonly>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
              <button type="button" class="btn-secondary" onclick="closeSuggestModal()">Annuler</button>
              <button type="submit" class="btn-primary">Envoyer</button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- √âTAPE 2 : Pr√©sentation professionnelle -->
      <div class="step-content" id="step2">
        <h2 class="step-title">Cr√©e ton profil professionnel</h2>
        <p class="step-description">Plus ton profil est complet, plus tu attires de clients !</p>
        
        <!-- Photo de profil -->
        <div class="profile-photo-section">
          <label class="section-label">üì∏ Photo de profil *</label>
          <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
            <div class="photo-preview" id="photoPreview">
              <span style="font-size: 48px; color: #9CA3AF;">üë§</span>
            </div>
            <div style="flex: 1; min-width: 200px;">
              <input type="file" id="profilePhoto" accept="image/*" style="display: none;" onchange="previewPhoto(event)">
              <button type="button" class="btn-upload" onclick="document.getElementById('profilePhoto').click()">
                üì∑ Choisir une photo
              </button>
              <p style="margin: 8px 0 0 0; font-size: 12px; color: #6B7280;">
                JPG, PNG max 1MB ‚Ä¢ Photo de profil
              </p>
            </div>
          </div>
        </div>
        
        <!-- Biographie -->
        <div class="form-group">
          <label for="bio">‚úçÔ∏è Biographie / Pr√©sentation *</label>
          <textarea id="bio" name="bio" class="textarea-modern" required
                    placeholder="Pr√©sente-toi ! Parle de ton parcours, ta passion, ton style de travail...&#10;&#10;Ex: Passionn√© de cr√©ation visuelle depuis toujours, je transforme les id√©es en designs impactants. Disponible pour des projets cr√©atifs √† La R√©union üå¥"></textarea>
          <small style="color: #6B7280; font-size: 12px;">Minimum 50 caract√®res ‚Ä¢ Plus c'est d√©taill√©, mieux c'est !</small>
        </div>
        
        <!-- Exp√©riences professionnelles -->
        <div class="form-group">
          <label class="section-label">üíº Exp√©riences professionnelles *</label>
          <p style="margin: 0 0 15px 0; font-size: 13px; color: #6B7280;">
            Ajoute tes exp√©riences comme sur un CV (au moins 1)
          </p>
          <div id="experiencesList">
            <div class="experience-item">
              <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                <input type="text" class="input-modern exp-title" placeholder="Ex: Graphiste freelance, Designer web..." required>
                <input type="text" class="input-modern exp-year-start" placeholder="Ex: 2020" required>
                <input type="text" class="input-modern exp-year-end" placeholder="Ex: 2024 ou En cours">
              </div>
              <textarea class="textarea-modern exp-description" rows="2" placeholder="D√©cris bri√®vement ce que tu as fait (optionnel)"></textarea>
              <button type="button" class="btn-remove-exp" onclick="removeExperience(this)" style="display: none; margin-top: 10px;">‚úï Supprimer</button>
              <hr style="margin: 20px 0; border: none; border-top: 1px dashed #E5E7EB;">
            </div>
          </div>
          <button type="button" class="btn-add-link" onclick="addExperience()">+ Ajouter une exp√©rience</button>
        </div>
        
        <!-- Comp√©tences -->
        <div class="form-group">
          <label class="section-label">üéØ Comp√©tences & outils ma√Ætris√©s *</label>
          <p style="margin: 0 0 15px 0; font-size: 13px; color: #6B7280;">
            Clique sur les logiciels/outils que tu ma√Ætrises (au moins 1)
          </p>
          
          <!-- Boutons logiciels/outils -->
          <div id="toolsButtons" style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px;">
            <!-- Design & Cr√©a -->
            <button type="button" class="btn-tool" data-tool="Photoshop">Photoshop</button>
            <button type="button" class="btn-tool" data-tool="Illustrator">Illustrator</button>
            <button type="button" class="btn-tool" data-tool="InDesign">InDesign</button>
            <button type="button" class="btn-tool" data-tool="Figma">Figma</button>
            <button type="button" class="btn-tool" data-tool="Canva">Canva</button>
            <button type="button" class="btn-tool" data-tool="Sketch">Sketch</button>
            <button type="button" class="btn-tool" data-tool="Affinity Designer">Affinity Designer</button>
            
            <!-- Montage & Vid√©o -->
            <button type="button" class="btn-tool" data-tool="Premiere Pro">Premiere Pro</button>
            <button type="button" class="btn-tool" data-tool="After Effects">After Effects</button>
            <button type="button" class="btn-tool" data-tool="Final Cut Pro">Final Cut Pro</button>
            <button type="button" class="btn-tool" data-tool="DaVinci Resolve">DaVinci Resolve</button>
            <button type="button" class="btn-tool" data-tool="CapCut">CapCut</button>
            <button type="button" class="btn-tool" data-tool="Sony Vegas">Sony Vegas</button>
            
            <!-- 3D & Animation -->
            <button type="button" class="btn-tool" data-tool="Blender">Blender</button>
            <button type="button" class="btn-tool" data-tool="Cinema 4D">Cinema 4D</button>
            <button type="button" class="btn-tool" data-tool="Maya">Maya</button>
            
            <!-- Web & Code -->
            <button type="button" class="btn-tool" data-tool="HTML/CSS">HTML/CSS</button>
            <button type="button" class="btn-tool" data-tool="JavaScript">JavaScript</button>
            <button type="button" class="btn-tool" data-tool="React">React</button>
            <button type="button" class="btn-tool" data-tool="WordPress">WordPress</button>
            <button type="button" class="btn-tool" data-tool="Shopify">Shopify</button>
            <button type="button" class="btn-tool" data-tool="Webflow">Webflow</button>
            
            <!-- Audio -->
            <button type="button" class="btn-tool" data-tool="Logic Pro">Logic Pro</button>
            <button type="button" class="btn-tool" data-tool="Ableton">Ableton</button>
            <button type="button" class="btn-tool" data-tool="Pro Tools">Pro Tools</button>
            <button type="button" class="btn-tool" data-tool="FL Studio">FL Studio</button>
            
            <!-- Bureautique & Marketing -->
            <button type="button" class="btn-tool" data-tool="Excel">Excel</button>
            <button type="button" class="btn-tool" data-tool="Google Ads">Google Ads</button>
            <button type="button" class="btn-tool" data-tool="SEO">SEO</button>
            <button type="button" class="btn-tool" data-tool="Meta Ads">Meta Ads</button>
          </div>
          
          <!-- Champs pour ajouter des outils custom -->
          <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
            <input type="text" id="customTool" class="input-modern" placeholder="Autre outil/logiciel..." style="flex: 1;">
            <button type="button" class="btn-add-tool" onclick="addCustomTool()">‚ûï Ajouter</button>
          </div>
          
          <!-- Liste des outils s√©lectionn√©s (cach√©e mais stocke les valeurs) -->
          <input type="hidden" id="competences" name="competences">
          <div id="selectedTools" style="margin-top: 10px; padding: 10px; background: #F9FAFB; border-radius: 8px; min-height: 40px; display: flex; flex-wrap: wrap; gap: 6px; align-items: center;">
            <span style="color: #9CA3AF; font-size: 13px;" id="placeholderTools">Aucun outil s√©lectionn√©</span>
          </div>
        </div>
        
        <!-- Portfolio / Projets -->
        <div class="form-group">
          <label class="section-label">üé® Portfolio & Projets</label>
          <p style="margin: 0 0 15px 0; font-size: 13px; color: #6B7280;">
            Ajoute des <strong>liens</strong> vers tes travaux, ou <strong>uploade des images</strong> de tes meilleurs projets
          </p>
          
          <!-- Liens portfolio -->
          <div style="margin-bottom: 20px;">
            <label style="font-size: 14px; font-weight: 600; color: #374151; display: block; margin-bottom: 8px;">
              üîó Liens (avec titre personnalis√©)
            </label>
            <div id="portfolioLinks">
              <div class="portfolio-link-item-with-title">
                <input type="text" class="input-modern portfolio-title" placeholder="Ex: Mon site web, Mes montages..." style="flex: 0 0 180px;">
                <input type="url" class="input-modern portfolio-input" placeholder="https://lien-vers-projet.com">
                <button type="button" class="btn-remove" onclick="removePortfolioLink(this)" style="display: none;">‚úï</button>
              </div>
            </div>
            <button type="button" class="btn-add-link" onclick="addPortfolioLink()">+ Ajouter un lien</button>
          </div>
          
          <!-- Upload images portfolio -->
          <div style="padding: 20px; background: #F9FAFB; border-radius: 12px; border: 2px dashed #D1D5DB;">
            <label style="font-size: 14px; font-weight: 600; color: #374151; display: block; margin-bottom: 8px;">
              üìÅ Images de tes projets
            </label>
            <input type="file" id="portfolioImages" accept="image/*" multiple style="display: none;" onchange="previewPortfolioImages(event)">
            <button type="button" class="btn-upload-portfolio" onclick="document.getElementById('portfolioImages').click()">
              üì§ Upload images
            </button>
            <p style="margin: 8px 0 0 0; font-size: 12px; color: #6B7280;">
              JPG, PNG ‚Ä¢ Multiple images ‚Ä¢ <span style="color: #F59E0B; font-weight: 600;">500MB total en offre gratuite</span>
            </p>
            <div id="portfolioPreview" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; margin-top: 15px;"></div>
          </div>
        </div>
        
        <!-- R√©seaux sociaux -->
        <div class="form-group">
          <label class="section-label">üåê R√©seaux sociaux (optionnel)</label>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div style="display: flex; align-items: center; gap: 10px;">
              <img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" alt="Instagram" style="width: 24px; height: 24px;">
              <input type="text" id="instagram" class="input-modern" placeholder="@ton_instagram">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <img src="https://cdn-icons-png.flaticon.com/512/733/733547.png" alt="Facebook" style="width: 24px; height: 24px;">
              <input type="text" id="facebook" class="input-modern" placeholder="facebook.com/ton-page">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <img src="https://cdn-icons-png.flaticon.com/512/174/174857.png" alt="LinkedIn" style="width: 24px; height: 24px;">
              <input type="text" id="linkedin" class="input-modern" placeholder="linkedin.com/in/ton-profil">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <img src="https://cdn-icons-png.flaticon.com/512/3046/3046121.png" alt="TikTok" style="width: 24px; height: 24px;">
              <input type="text" id="tiktok" class="input-modern" placeholder="@ton_tiktok">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png" alt="YouTube" style="width: 24px; height: 24px;">
              <input type="text" id="youtube" class="input-modern" placeholder="youtube.com/@ton-chaine">
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <img src="https://cdn-icons-png.flaticon.com/512/733/733579.png" alt="Twitter/X" style="width: 24px; height: 24px;">
              <input type="text" id="twitter" class="input-modern" placeholder="@ton_twitter">
            </div>
          </div>
        </div>
        
        <div class="form-actions">
          <button class="btn-secondary" onclick="prevStep(1)">‚Üê Pr√©c√©dent</button>
          <button class="btn-primary" onclick="nextStep(3)">Suivant ‚Üí</button>
        </div>
      </div>
      
      <!-- √âTAPE 3 : Services propos√©s -->
      <div class="step-content" id="step3">
        <h2 class="step-title">üì¶ Tes services propos√©s</h2>
        <p class="step-description">Liste les services que tu proposes avec leurs descriptions et tarifs</p>
        
        <div id="servicesList" style="display: flex; flex-direction: column; gap: 20px; margin-bottom: 20px;">
          <!-- Service 1 par d√©faut -->
          <div class="service-item" style="background: #F9FAFB; padding: 20px; border-radius: 12px; border: 2px solid #E5E7EB;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
              <h3 style="margin: 0; color: var(--primary); font-size: 16px;">Service #1</h3>
              <button type="button" class="btn-remove-service" onclick="removeService(this)" style="display: none; background: #EF4444; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 13px;">‚úï Retirer</button>
            </div>
            
            <div style="display: grid; gap: 15px;">
              <div>
                <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
                  Ic√¥ne du service
                </label>
                <select class="input-modern service-icon" style="width: 100%;">
                  <option value="üé®">üé® Design</option>
                  <option value="üì±">üì± Digital</option>
                  <option value="üñ•Ô∏è">üñ•Ô∏è Web</option>
                  <option value="üì∏">üì∏ Photo</option>
                  <option value="üé•">üé• Vid√©o</option>
                  <option value="‚úèÔ∏è">‚úèÔ∏è R√©daction</option>
                  <option value="üíº">üíº Business</option>
                  <option value="üè∑Ô∏è">üè∑Ô∏è Branding</option>
                  <option value="üìÑ">üìÑ Documents</option>
                  <option value="üé≠">üé≠ Cr√©atif</option>
                  <option value="üì¶">üì¶ Autre</option>
                </select>
              </div>
              
              <div>
                <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
                  Nom du service *
                </label>
                <input type="text" class="input-modern service-name" placeholder="Ex: Cr√©ation de logo professionnel" required>
              </div>
              
              <div>
                <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
                  Description *
                </label>
                <textarea class="input-modern service-description" rows="3" placeholder="D√©cris ce que tu proposes et ce qui est inclus..." required style="resize: vertical;"></textarea>
              </div>
              
              <div>
                <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
                  Tarif (‚Ç¨) *
                </label>
                <input type="number" class="input-modern service-price" placeholder="150" min="0" step="10" required>
                <small style="color: #6B7280; font-size: 12px;">Prix de d√©part "√Ä partir de..."</small>
              </div>
            </div>
          </div>
        </div>
        
        <button type="button" class="btn-add-service" onclick="addService()" style="width: 100%; padding: 12px 20px; background: var(--secondary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 20px;">
          ‚ûï Ajouter un service
        </button>
        
        <p style="background: #EFF6FF; padding: 12px; border-radius: 8px; font-size: 13px; color: #1E40AF; margin-bottom: 20px;">
          üí° <strong>Astuce :</strong> Plus tes services sont d√©taill√©s, plus tu as de chances d'attirer des clients !
        </p>
        
        <div class="form-actions">
          <button class="btn-secondary" onclick="prevStep(2)">‚Üê Pr√©c√©dent</button>
          <button class="btn-primary" onclick="nextStep(4)">Continuer ‚Üí</button>
        </div>
      </div>
      
      <!-- √âTAPE 4 : Tarifs g√©n√©raux -->
      <div class="step-content" id="step4">
        <h2 class="step-title">D√©finis tes tarifs g√©n√©raux</h2>
        <p class="step-description">Indique tes prix globaux pour que les clients aient une id√©e de ton budget</p>
        
        <div class="form-group">
          <label for="tarifHoraire">Tarif horaire (en ‚Ç¨)</label>
          <input type="number" id="tarifHoraire" name="tarifHoraire" min="10" step="5"
                 placeholder="Ex: 25">
          <small style="color: #6B7280;">Optionnel si tu pr√©f√®res facturer au projet</small>
        </div>
        
        <div class="form-group">
          <label for="tarifMinimum">Tarif minimum par prestation (en ‚Ç¨) *</label>
          <input type="number" id="tarifMinimum" name="tarifMinimum" min="0" step="10" required
                 placeholder="Ex: 50">
          <small style="color: #6B7280;">Le montant minimum que tu acceptes pour une prestation</small>
        </div>
        
        <div class="form-group">
          <label for="disponibilite">Disponibilit√© *</label>
          <select id="disponibilite" name="disponibilite" required>
            <option value="">S√©lectionne...</option>
            <option value="immediat">Disponible imm√©diatement</option>
            <option value="semaine">Dans la semaine</option>
            <option value="mois">Dans le mois</option>
            <option value="flexible">Selon le projet</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="zoneIntervention">Zone d'intervention *</label>
          <select id="zoneIntervention" name="zoneIntervention" required>
            <option value="">S√©lectionne...</option>
            
            <optgroup label="üìç Villes principales">
              <option value="Saint-Denis">Saint-Denis</option>
              <option value="Saint-Paul">Saint-Paul</option>
              <option value="Saint-Pierre">Saint-Pierre</option>
              <option value="Le Tampon">Le Tampon</option>
              <option value="Saint-Andr√©">Saint-Andr√©</option>
              <option value="Saint-Louis">Saint-Louis</option>
              <option value="Saint-Beno√Æt">Saint-Beno√Æt</option>
              <option value="Le Port">Le Port</option>
              <option value="La Possession">La Possession</option>
              <option value="Saint-Joseph">Saint-Joseph</option>
              <option value="Saint-Leu">Saint-Leu</option>
            </optgroup>
            
            <optgroup label="üó∫Ô∏è Autres communes">
              <option value="Sainte-Marie">Sainte-Marie</option>
              <option value="Sainte-Suzanne">Sainte-Suzanne</option>
              <option value="Bras-Panon">Bras-Panon</option>
              <option value="Salazie">Salazie</option>
              <option value="Saint-Philippe">Saint-Philippe</option>
              <option value="Sainte-Rose">Sainte-Rose</option>
              <option value="Les Avirons">Les Avirons</option>
              <option value="L'√âtang-Sal√©">L'√âtang-Sal√©</option>
              <option value="Petite-√éle">Petite-√éle</option>
              <option value="Entre-Deux">Entre-Deux</option>
              <option value="Cilaos">Cilaos</option>
              <option value="La Plaine-des-Palmistes">La Plaine-des-Palmistes</option>
              <option value="Trois-Bassins">Trois-Bassins</option>
            </optgroup>
            
            <optgroup label="üß≠ Zones g√©ographiques">
              <option value="nord">Nord</option>
              <option value="sud">Sud</option>
              <option value="est">Est</option>
              <option value="ouest">Ouest</option>
              <option value="toute-ile">Toute l'√Æle</option>
            </optgroup>
            
            <optgroup label="üíª Autres">
              <option value="distance">√Ä distance uniquement</option>
            </optgroup>
          </select>
        </div>
        
        <div class="form-actions">
          <button class="btn-secondary" onclick="prevStep(3)">‚Üê Pr√©c√©dent</button>
          <button class="btn-primary" onclick="completeOnboarding()">‚úÖ Terminer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- üíé Modal Premium Finale (obligatoire) -->
  <div id="premiumModalFinal" class="premium-modal-overlay" style="display: none;">
    <div class="premium-modal-content">
      <div class="premium-modal-header">
        <span class="premium-badge">‚≠ê OFFRE PREMIUM</span>
        <h2 style="margin: 15px 0 8px 0; font-size: 26px; color: #1F2937;">Avant de terminer, profite de notre offre Premium !</h2>
        <p style="margin: 0; font-size: 15px; color: #6B7280;">D√©marre fort avec des avantages exclusifs üöÄ</p>
      </div>
      
      <div class="premium-plans">
        <!-- Plan Mensuel -->
        <div class="premium-plan premium-plan-modal" data-plan="monthly" onclick="selectPremiumPlanModal('monthly')">
          <div class="plan-header">
            <span class="plan-period">Mensuel</span>
            <div class="plan-price">
              <span class="price-amount">13,99‚Ç¨</span>
              <span class="price-period">/mois</span>
            </div>
          </div>
          <ul class="plan-features">
            <li>‚úì Badge v√©rifi√© ‚úÖ</li>
            <li>‚úì 2 Go de stockage</li>
            <li>‚úì Profil mis en avant</li>
            <li>‚úì Statistiques avanc√©es</li>
            <li>‚úì Support prioritaire</li>
          </ul>
          <button type="button" class="btn-select-plan">Choisir Mensuel</button>
        </div>
        
        <!-- Plan Annuel (meilleur deal) -->
        <div class="premium-plan premium-plan-modal premium-plan-best" data-plan="yearly" onclick="selectPremiumPlanModal('yearly')">
          <div class="best-deal-badge">üî• MEILLEUR CHOIX</div>
          <div class="plan-header">
            <span class="plan-period">Annuel</span>
            <div class="plan-price">
              <span class="price-amount">149,99‚Ç¨</span>
              <span class="price-period">/an</span>
            </div>
            <span class="plan-saving">√âconomise 17,89‚Ç¨</span>
          </div>
          <ul class="plan-features">
            <li>‚úì Badge v√©rifi√© ‚úÖ</li>
            <li>‚úì 2 Go de stockage</li>
            <li>‚úì Profil mis en avant</li>
            <li>‚úì Statistiques avanc√©es</li>
            <li>‚úì Support prioritaire</li>
          </ul>
          <button type="button" class="btn-select-plan btn-select-plan-best">Choisir Annuel</button>
        </div>
      </div>
      
      <button type="button" class="btn-skip-premium-modal" onclick="skipPremiumModal()">
        Non merci, je continue en version gratuite ‚Üí
      </button>
    </div>
  </div>

  <script src="js/supabase-config.js?v=20241217-0110"></script>
  <script src="js/main.js?v=20241203-0300"></script>
  <script>
    // Donn√©es du formulaire
    let onboardingData = {
      categories: [],
      profilePhotoFile: null,
      profilePhotoUrl: '',
      portfolioImageFiles: [],
      bio: '',
      experience: '',
      competences: '',
      portfolioLinks: [],
      socialMedia: {
        instagram: '',
        facebook: '',
        linkedin: '',
        tiktok: ''
      },
      premiumPlan: null, // 'monthly', 'yearly', ou null
      tarifHoraire: null,
      tarifMinimum: null,
      disponibilite: '',
      zoneIntervention: ''
    };
    
    // Pr√©visualisation photo de profil
    function previewPhoto(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      // V√©rifier la taille (1MB max pour photo de profil)
      if (file.size > 1 * 1024 * 1024) {
        showToast('error', 'Fichier trop lourd', 'La photo de profil doit faire moins de 1MB.');
        return;
      }
      
      // V√©rifier le type
      if (!file.type.startsWith('image/')) {
        showToast('error', 'Format invalide', 'Choisis une image (JPG, PNG, etc.).');
        return;
      }
      
      onboardingData.profilePhotoFile = file;
      
      // Afficher la pr√©visualisation
      const reader = new FileReader();
      reader.onload = (e) => {
        const preview = document.getElementById('photoPreview');
        preview.innerHTML = `<img src="${e.target.result}" alt="Photo de profil">`;
      };
      reader.readAsDataURL(file);
    }
    
    // Pr√©visualisation images portfolio
    function previewPortfolioImages(event) {
      const files = Array.from(event.target.files);
      if (files.length === 0) return;
      
      // V√©rifier la taille totale
      const totalSize = files.reduce((sum, file) => sum + file.size, 0);
      const currentSize = onboardingData.portfolioImageFiles.reduce((sum, file) => sum + file.size, 0);
      const totalMB = (totalSize + currentSize) / (1024 * 1024);
      
      if (totalMB > 500) {
        showToast('error', 'Limite d√©pass√©e', `Total: ${totalMB.toFixed(0)}MB. Max 500MB en offre gratuite.`);
        return;
      }
      
      // Ajouter les fichiers
      files.forEach(file => {
        if (!file.type.startsWith('image/')) return;
        
        onboardingData.portfolioImageFiles.push(file);
        
        // Afficher preview
        const reader = new FileReader();
        reader.onload = (e) => {
          const preview = document.getElementById('portfolioPreview');
          const div = document.createElement('div');
          div.className = 'portfolio-image-preview';
          div.innerHTML = `
            <img src="${e.target.result}" alt="Projet">
            <button class="remove-img" onclick="removePortfolioImage(${onboardingData.portfolioImageFiles.length - 1})">‚úï</button>
          `;
          preview.appendChild(div);
        };
        reader.readAsDataURL(file);
      });
      
      const sizeMB = (totalSize + currentSize) / (1024 * 1024);
      showToast('info', 'Images ajout√©es', `${files.length} image(s) ‚Ä¢ ${sizeMB.toFixed(1)}MB / 500MB`);
    }
    
    // Retirer une image portfolio
    function removePortfolioImage(index) {
      onboardingData.portfolioImageFiles.splice(index, 1);
      
      // Rafra√Æchir l'affichage
      const preview = document.getElementById('portfolioPreview');
      preview.innerHTML = '';
      
      onboardingData.portfolioImageFiles.forEach((file, i) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          const div = document.createElement('div');
          div.className = 'portfolio-image-preview';
          div.innerHTML = `
            <img src="${e.target.result}" alt="Projet">
            <button class="remove-img" onclick="removePortfolioImage(${i})">‚úï</button>
          `;
          preview.appendChild(div);
        };
        reader.readAsDataURL(file);
      });
    }
    
    // Ajouter un lien portfolio
    function addPortfolioLink() {
      const container = document.getElementById('portfolioLinks');
      const newItem = document.createElement('div');
      newItem.className = 'portfolio-link-item-with-title';
      newItem.innerHTML = `
        <input type="text" class="input-modern portfolio-title" placeholder="Ex: Mon site web..." style="flex: 0 0 180px;">
        <input type="url" class="input-modern portfolio-input" placeholder="https://lien-vers-projet.com">
        <button type="button" class="btn-remove" onclick="removePortfolioLink(this)">‚úï</button>
      `;
      container.appendChild(newItem);
    }
    
    // Retirer un lien portfolio
    function removePortfolioLink(btn) {
      btn.closest('.portfolio-link-item-with-title').remove();
      
      // S'il ne reste qu'un seul champ, cacher son bouton de suppression
      const items = document.querySelectorAll('.portfolio-link-item-with-title');
      if (items.length === 1) {
        const removeBtn = items[0].querySelector('.btn-remove');
        if (removeBtn) removeBtn.style.display = 'none';
      }
    }
    
    // Ajouter une exp√©rience
    function addExperience() {
      const container = document.getElementById('experiencesList');
      const newItem = document.createElement('div');
      newItem.className = 'experience-item';
      newItem.innerHTML = `
        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; margin-bottom: 10px;">
          <input type="text" class="input-modern exp-title" placeholder="Ex: Graphiste freelance..." required>
          <input type="text" class="input-modern exp-year-start" placeholder="Ex: 2020" required>
          <input type="text" class="input-modern exp-year-end" placeholder="Ex: 2024 ou En cours">
        </div>
        <textarea class="textarea-modern exp-description" rows="2" placeholder="D√©cris bri√®vement ce que tu as fait (optionnel)"></textarea>
        <button type="button" class="btn-remove-exp" onclick="removeExperience(this)" style="margin-top: 10px;">‚úï Supprimer</button>
        <hr style="margin: 20px 0; border: none; border-top: 1px dashed #E5E7EB;">
      `;
      container.appendChild(newItem);
    }
    
    // Retirer une exp√©rience
    function removeExperience(btn) {
      btn.closest('.experience-item').remove();
      
      // S'il ne reste qu'une seule exp√©rience, cacher son bouton de suppression
      const items = document.querySelectorAll('.experience-item');
      if (items.length === 1) {
        const removeBtn = items[0].querySelector('.btn-remove-exp');
        if (removeBtn) removeBtn.style.display = 'none';
      }
    }
    
    // üõ†Ô∏è Gestion des outils/comp√©tences
    let selectedTools = [];
    
    // Initialiser les boutons d'outils
    document.addEventListener('DOMContentLoaded', () => {
      const toolButtons = document.querySelectorAll('.btn-tool');
      toolButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const tool = btn.dataset.tool;
          
          if (btn.classList.contains('selected')) {
            // D√©s√©lectionner
            btn.classList.remove('selected');
            selectedTools = selectedTools.filter(t => t !== tool);
          } else {
            // S√©lectionner
            btn.classList.add('selected');
            if (!selectedTools.includes(tool)) {
              selectedTools.push(tool);
            }
          }
          
          updateSelectedToolsDisplay();
        });
      });
    });
    
    // Ajouter un outil custom
    function addCustomTool() {
      const input = document.getElementById('customTool');
      const tool = input.value.trim();
      
      if (!tool) {
        showToast('warning', 'Champ vide', 'Saisis le nom de l\'outil.');
        return;
      }
      
      if (selectedTools.includes(tool)) {
        showToast('info', 'D√©j√† ajout√©', 'Cet outil est d√©j√† dans ta liste.');
        input.value = '';
        return;
      }
      
      selectedTools.push(tool);
      updateSelectedToolsDisplay();
      input.value = '';
      showToast('success', 'Outil ajout√©', `${tool} ajout√© √† tes comp√©tences.`);
    }
    
    // üì¶ Gestion des services
    function addService() {
      const container = document.getElementById('servicesList');
      const serviceCount = container.querySelectorAll('.service-item').length;
      
      const newService = document.createElement('div');
      newService.className = 'service-item';
      newService.style.cssText = 'background: #F9FAFB; padding: 20px; border-radius: 12px; border: 2px solid #E5E7EB;';
      newService.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h3 style="margin: 0; color: var(--primary); font-size: 16px;">Service #${serviceCount + 1}</h3>
          <button type="button" class="btn-remove-service" onclick="removeService(this)" style="background: #EF4444; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 13px;">‚úï Retirer</button>
        </div>
        
        <div style="display: grid; gap: 15px;">
          <div>
            <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
              Ic√¥ne du service
            </label>
            <select class="input-modern service-icon" style="width: 100%;">
              <option value="üé®">üé® Design</option>
              <option value="üì±">üì± Digital</option>
              <option value="üñ•Ô∏è">üñ•Ô∏è Web</option>
              <option value="üì∏">üì∏ Photo</option>
              <option value="üé•">üé• Vid√©o</option>
              <option value="‚úèÔ∏è">‚úèÔ∏è R√©daction</option>
              <option value="üíº">üíº Business</option>
              <option value="üè∑Ô∏è">üè∑Ô∏è Branding</option>
              <option value="üìÑ">üìÑ Documents</option>
              <option value="üé≠">üé≠ Cr√©atif</option>
              <option value="üì¶">üì¶ Autre</option>
            </select>
          </div>
          
          <div>
            <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
              Nom du service *
            </label>
            <input type="text" class="input-modern service-name" placeholder="Ex: Cr√©ation de logo professionnel" required>
          </div>
          
          <div>
            <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
              Description *
            </label>
            <textarea class="input-modern service-description" rows="3" placeholder="D√©cris ce que tu proposes et ce qui est inclus..." required style="resize: vertical;"></textarea>
          </div>
          
          <div>
            <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 6px;">
              Tarif (‚Ç¨) *
            </label>
            <input type="number" class="input-modern service-price" placeholder="150" min="0" step="10" required>
            <small style="color: #6B7280; font-size: 12px;">Prix de d√©part "√Ä partir de..."</small>
          </div>
        </div>
      `;
      
      container.appendChild(newService);
      
      // Afficher le bouton supprimer du premier service s'il √©tait cach√©
      const firstService = container.querySelector('.service-item');
      const firstRemoveBtn = firstService.querySelector('.btn-remove-service');
      if (firstRemoveBtn) firstRemoveBtn.style.display = 'block';
      
      showToast('success', 'Service ajout√©', 'Tu peux maintenant remplir les informations');
    }
    
    function removeService(btn) {
      const serviceItem = btn.closest('.service-item');
      const container = document.getElementById('servicesList');
      
      serviceItem.remove();
      
      // Renommer les services restants
      const services = container.querySelectorAll('.service-item');
      services.forEach((item, index) => {
        const title = item.querySelector('h3');
        if (title) title.textContent = `Service #${index + 1}`;
      });
      
      // Si une seule reste, cacher son bouton supprimer
      if (services.length === 1) {
        const removeBtn = services[0].querySelector('.btn-remove-service');
        if (removeBtn) removeBtn.style.display = 'none';
      }
      
      showToast('info', 'Service retir√©', 'Le service a √©t√© supprim√©');
    }
    
    // Ajouter un outil custom
    function addCustomTool() {
      const input = document.getElementById('customTool');
      const tool = input.value.trim();
      
      if (!tool) {
        showToast('warning', 'Champ vide', 'Saisis le nom de l\'outil.');
        return;
      }
      
      if (selectedTools.includes(tool)) {
        showToast('info', 'D√©j√† ajout√©', 'Cet outil est d√©j√† dans ta liste.');
        input.value = '';
        return;
      }
      
      selectedTools.push(tool);
      updateSelectedToolsDisplay();
      input.value = '';
      showToast('success', 'Outil ajout√©', `${tool} ajout√© √† tes comp√©tences.`);
    }
    
    // Retirer un outil
    function removeTool(tool) {
      selectedTools = selectedTools.filter(t => t !== tool);
      
      // D√©s√©lectionner le bouton si c'est un outil pr√©-d√©fini
      const btn = document.querySelector(`.btn-tool[data-tool="${tool}"]`);
      if (btn) btn.classList.remove('selected');
      
      updateSelectedToolsDisplay();
    }
    
    // Mettre √† jour l'affichage des outils s√©lectionn√©s
    function updateSelectedToolsDisplay() {
      const container = document.getElementById('selectedTools');
      const hiddenInput = document.getElementById('competences');
      const placeholder = document.getElementById('placeholderTools');
      
      if (selectedTools.length === 0) {
        container.innerHTML = '<span style="color: #9CA3AF; font-size: 13px;" id="placeholderTools">Aucun outil s√©lectionn√©</span>';
        hiddenInput.value = '';
        return;
      }
      
      // Masquer le placeholder
      if (placeholder) placeholder.remove();
      
      // Afficher les tags
      container.innerHTML = selectedTools.map(tool => `
        <span class="selected-tool-tag">
          ${tool}
          <button onclick="removeTool('${tool}')">‚úï</button>
        </span>
      `).join('');
      
      // Mettre √† jour le champ cach√© pour validation
      hiddenInput.value = selectedTools.join(', ');
    }
    
    // üíé Gestion Modal Premium Finale
    function selectPremiumPlanModal(plan) {
      onboardingData.premiumPlan = plan;
      
      // Retirer s√©lection
      document.querySelectorAll('.premium-plan-modal').forEach(p => p.classList.remove('selected'));
      
      // Ajouter s√©lection
      const planElement = document.querySelector(`.premium-plan-modal[data-plan="${plan}"]`);
      if (planElement) {
        planElement.classList.add('selected');
      }
      
      // Toast de confirmation
      const planName = plan === 'yearly' ? 'Plan Annuel (149,99‚Ç¨/an)' : 'Plan Mensuel (13,99‚Ç¨/mois)';
      showToast('success', 'üíé Premium activ√© !', `${planName} s√©lectionn√©`);
      
      // Fermer la modal et continuer la sauvegarde
      setTimeout(() => {
        document.getElementById('premiumModalFinal').style.display = 'none';
        saveOnboardingData();
      }, 800);
    }
    
    function skipPremiumModal() {
      onboardingData.premiumPlan = null;
      showToast('info', 'Version gratuite', 'Tu pourras passer Premium plus tard.');
      
      // Fermer la modal et continuer
      setTimeout(() => {
        document.getElementById('premiumModalFinal').style.display = 'none';
        saveOnboardingData();
      }, 500);
    }
    
    // Gestion de la s√©lection des cat√©gories
    document.querySelectorAll('.category-option').forEach(option => {
      option.addEventListener('click', () => {
        const category = option.dataset.category;
        option.classList.toggle('selected');
        
        if (option.classList.contains('selected')) {
          if (!onboardingData.categories.includes(category)) {
            onboardingData.categories.push(category);
          }
        } else {
          onboardingData.categories = onboardingData.categories.filter(c => c !== category);
        }
      });
    });
    
    // Navigation entre √©tapes
    function nextStep(stepNumber) {
      // Validation de l'√©tape actuelle
      if (stepNumber === 2) {
        if (onboardingData.categories.length === 0) {
          showToast('error', 'Cat√©gorie requise', 'S√©lectionne au moins une cat√©gorie de service dans l\'√©tape 1.');
          return;
        }
      }
      
      if (stepNumber === 3) {
        const bio = document.getElementById('bio').value;
        const competences = document.getElementById('competences').value;
        
        // Liste des champs manquants pour message pr√©cis
        const missingFields = [];
        
        // R√©cup√©rer toutes les exp√©riences
        const experienceItems = document.querySelectorAll('.experience-item');
        const experiences = [];
        let hasValidExperience = false;
        
        experienceItems.forEach(item => {
          const title = item.querySelector('.exp-title').value.trim();
          const yearStart = item.querySelector('.exp-year-start').value.trim();
          const yearEnd = item.querySelector('.exp-year-end').value.trim();
          const description = item.querySelector('.exp-description').value.trim();
          
          if (title && yearStart) {
            hasValidExperience = true;
            experiences.push({
              title: title,
              yearStart: yearStart,
              yearEnd: yearEnd || 'En cours',
              description: description
            });
          }
        });
        
        if (!hasValidExperience) {
          missingFields.push('Au moins 1 exp√©rience professionnelle');
        }
        
        if (!bio || bio.length < 50) {
          missingFields.push('Biographie (minimum 50 caract√®res)');
        }
        
        if (!competences) {
          missingFields.push('Comp√©tences & outils ma√Ætris√©s');
        }
        
        // Afficher tous les champs manquants
        if (missingFields.length > 0) {
          const fieldsList = missingFields.join('<br>‚Ä¢ ');
          showToast('error', 'Champs obligatoires manquants', `‚Ä¢ ${fieldsList}`);
          return;
        }
        
        // R√©cup√©rer les liens portfolio avec titres
        const portfolioItems = document.querySelectorAll('.portfolio-link-item-with-title');
        const links = [];
        portfolioItems.forEach(item => {
          const title = item.querySelector('.portfolio-title').value.trim();
          const url = item.querySelector('.portfolio-input').value.trim();
          if (url) {
            links.push({
              title: title || 'Projet',
              url: url
            });
          }
        });
        
        // R√©cup√©rer les r√©seaux sociaux
        const instagram = document.getElementById('instagram').value.trim();
        const facebook = document.getElementById('facebook').value.trim();
        const linkedin = document.getElementById('linkedin').value.trim();
        const tiktok = document.getElementById('tiktok').value.trim();
        const youtube = document.getElementById('youtube') ? document.getElementById('youtube').value.trim() : '';
        const twitter = document.getElementById('twitter') ? document.getElementById('twitter').value.trim() : '';
        
        onboardingData.bio = bio;
        onboardingData.experience = experiences;
        onboardingData.competences = competences;
        onboardingData.portfolioLinks = links;
        onboardingData.socialMedia = {
          instagram: instagram,
          facebook: facebook,
          linkedin: linkedin,
          tiktok: tiktok,
          youtube: youtube,
          twitter: twitter
        };
      }
      
      // Changer d'√©tape
      document.querySelectorAll('.step-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById('step' + stepNumber).classList.add('active');
      
      document.querySelectorAll('.step').forEach(step => {
        step.classList.remove('active');
      });
      document.querySelector(`.step[data-step="${stepNumber}"]`).classList.add('active');
      
      // Mettre √† jour la barre de progression
      const progress = (stepNumber / 4) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      window.scrollTo(0, 0);
    }
    
    // Navigation directe vers une √©tape (clic sur les num√©ros)
    function goToStep(stepNumber) {
      // Changer l'affichage sans validation (permet de revenir en arri√®re)
      document.querySelectorAll('.step-content').forEach(content => {
        content.classList.remove('active');
      });
      document.getElementById('step' + stepNumber).classList.add('active');
      
      document.querySelectorAll('.step').forEach(step => {
        step.classList.remove('active');
      });
      document.querySelector(`.step[data-step="${stepNumber}"]`).classList.add('active');
      
      // Mettre √† jour la barre de progression
      const progress = (stepNumber / 4) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      window.scrollTo(0, 0);
    }
    
    // Ouvrir la modal Premium √† tout moment
    function openPremiumModal() {
      document.getElementById('premiumModalFinal').style.display = 'flex';
    }
    
    function prevStep(stepNumber) {
      nextStep(stepNumber);
    }
    
    // Compl√©ter l'onboarding
    async function completeOnboarding() {
      // Validation et r√©cup√©ration des services (√©tape 3)
      const serviceItems = document.querySelectorAll('.service-item');
      const services = [];
      let hasValidService = false;
      
      serviceItems.forEach(item => {
        const icon = item.querySelector('.service-icon').value;
        const name = item.querySelector('.service-name').value.trim();
        const description = item.querySelector('.service-description').value.trim();
        const price = item.querySelector('.service-price').value;
        
        if (name && description && price) {
          hasValidService = true;
          services.push({
            icon: icon,
            name: name,
            description: description,
            price: parseInt(price)
          });
        }
      });
      
      if (!hasValidService) {
        showToast('error', 'Services manquants', 'Ajoute au moins un service avec nom, description et tarif');
        goToStep(3);
        return;
      }
      
      onboardingData.services = services;
      
      // R√©cup√©rer les donn√©es de l'√©tape 4 (tarifs g√©n√©raux)
      const tarifHoraire = document.getElementById('tarifHoraire').value;
      const tarifMinimum = document.getElementById('tarifMinimum').value;
      const disponibilite = document.getElementById('disponibilite').value;
      const zoneIntervention = document.getElementById('zoneIntervention').value;
      
      // Liste des champs manquants
      const missingFields = [];
      
      if (!tarifMinimum) missingFields.push('Tarif minimum');
      if (!disponibilite) missingFields.push('Disponibilit√©');
      if (!zoneIntervention) missingFields.push('Zone d\'intervention');
      
      if (missingFields.length > 0) {
        const fieldsList = missingFields.join('<br>‚Ä¢ ');
        showToast('error', 'Champs obligatoires manquants', `‚Ä¢ ${fieldsList}`);
        return;
      }
      
      onboardingData.tarifHoraire = tarifHoraire ? parseInt(tarifHoraire) : null;
      onboardingData.tarifMinimum = parseInt(tarifMinimum);
      onboardingData.disponibilite = disponibilite;
      onboardingData.zoneIntervention = zoneIntervention;
      
      // üéØ AFFICHER LA MODAL PREMIUM OBLIGATOIRE
      // Si pas encore de plan s√©lectionn√©, afficher la modal
      if (!onboardingData.premiumPlan) {
        document.getElementById('premiumModalFinal').style.display = 'flex';
        return; // Bloquer ici jusqu'√† ce qu'il choisisse
      }
      
      // Continuer la sauvegarde si plan d√©j√† choisi (ou skip)
      saveOnboardingData();
    }
    
    // Fonction pour sauvegarder r√©ellement les donn√©es
    async function saveOnboardingData() {
      const btn = document.querySelector('.btn-primary');
      btn.disabled = true;
      btn.textContent = '‚è≥ Sauvegarde en cours...';
      
      try {
        // R√©cup√©rer l'utilisateur connect√©
        const { data: { user } } = await supabase.auth.getUser();
        
        if (!user) {
          throw new Error('Utilisateur non connect√©');
        }
        
        let profilePhotoUrl = '';
        const portfolioImageUrls = [];
        
        // Upload de la photo de profil si pr√©sente
        if (onboardingData.profilePhotoFile) {
          btn.textContent = 'üì§ Upload photo profil...';
          
          const fileExt = onboardingData.profilePhotoFile.name.split('.').pop();
          const fileName = `${user.id}-profile.${fileExt}`;
          const filePath = `profile-photos/${fileName}`;
          
          const { error: uploadError } = await supabase.storage
            .from('user-content')
            .upload(filePath, onboardingData.profilePhotoFile, { upsert: true });
          
          if (uploadError) {
            console.warn('Erreur upload photo:', uploadError);
          } else {
            const { data: urlData } = supabase.storage
              .from('user-content')
              .getPublicUrl(filePath);
            
            profilePhotoUrl = urlData.publicUrl;
          }
        }
        
        // Upload des images portfolio si pr√©sentes
        if (onboardingData.portfolioImageFiles.length > 0) {
          btn.textContent = `üì§ Upload projets (0/${onboardingData.portfolioImageFiles.length})...`;
          
          for (let i = 0; i < onboardingData.portfolioImageFiles.length; i++) {
            const file = onboardingData.portfolioImageFiles[i];
            const fileExt = file.name.split('.').pop();
            const fileName = `${user.id}-project-${Date.now()}-${i}.${fileExt}`;
            const filePath = `portfolio/${fileName}`;
            
            btn.textContent = `üì§ Upload projets (${i + 1}/${onboardingData.portfolioImageFiles.length})...`;
            
            const { error: uploadError } = await supabase.storage
              .from('user-content')
              .upload(filePath, file);
            
            if (uploadError) {
              console.warn('Erreur upload image portfolio:', uploadError);
            } else {
              const { data: urlData } = supabase.storage
                .from('user-content')
                .getPublicUrl(filePath);
              
              portfolioImageUrls.push(urlData.publicUrl);
            }
          }
        }
        
        btn.textContent = 'üíæ Sauvegarde...';
        
        // Mettre √† jour le profil avec toutes les donn√©es
        const { error } = await supabase
          .from('profiles')
          .update({
            categories: onboardingData.categories,
            profile_photo: profilePhotoUrl,
            bio: onboardingData.bio,
            experience: onboardingData.experience,
            competences: onboardingData.competences.split(',').map(c => c.trim()),
            services: onboardingData.services, // Les services propos√©s
            portfolio_links: onboardingData.portfolioLinks,
            portfolio_images: portfolioImageUrls,
            social_media: onboardingData.socialMedia,
            premium_plan: onboardingData.premiumPlan, // Plan premium choisi (monthly/yearly/null)
            tarif_horaire: onboardingData.tarifHoraire,
            tarif_minimum: onboardingData.tarifMinimum,
            disponibilite: onboardingData.disponibilite,
            zone_intervention: onboardingData.zoneIntervention,
            onboarding_completed: true,
            updated_at: new Date().toISOString()
          })
          .eq('id', user.id);
        
        if (error) throw error;
        
        showToast('success', 'Profil compl√©t√© !', 'Ton profil pro est maintenant en ligne üéâ');
        
        setTimeout(() => {
          window.location.href = 'tableau-de-bord.html';
        }, 2000);
        
      } catch (error) {
        console.error('Erreur:', error);
        showToast('error', 'Erreur', 'Impossible de sauvegarder ton profil. R√©essaye.');
        btn.textContent = '‚úÖ Terminer';
        btn.disabled = false;
      }
    }
    
    // V√©rifier si l'utilisateur est connect√©
    window.addEventListener('load', async () => {
      const { data: { user } } = await supabase.auth.getUser();
      
      if (!user) {
        window.location.href = 'connexion.html';
        return;
      }
      
      // V√©rifier si c'est un marronneur
      try {
        const { data: profile, error } = await supabase
          .from('profiles')
          .select('user_type')
          .eq('id', user.id)
          .single();
        
        if (error) {
          console.error('Erreur chargement profil:', error);
        }
        
        // Si ce n'est pas un marronneur, rediriger
        if (profile && profile.user_type !== 'marronneur') {
          showToast('info', 'Acc√®s r√©serv√©', 'Cette page est r√©serv√©e aux marronneurs');
          setTimeout(() => {
            window.location.href = 'tableau-de-bord.html';
          }, 1500);
          return;
        }
        
      } catch (err) {
        console.error('Erreur v√©rification profil:', err);
      }
      
      // Pr√©-remplir l'email dans le formulaire de suggestion
      if (user && user.email) {
        document.getElementById('suggestEmail').value = user.email;
      }
    });
    
    // Gestion du modal de suggestion
    function openSuggestModal() {
      document.getElementById('suggestModal').style.display = 'flex';
    }
    
    function closeSuggestModal(event) {
      if (!event || event.target.id === 'suggestModal') {
        document.getElementById('suggestModal').style.display = 'none';
        document.getElementById('suggestForm').reset();
        // Re-remplir l'email
        supabase.auth.getUser().then(({ data: { user } }) => {
          if (user && user.email) {
            document.getElementById('suggestEmail').value = user.email;
          }
        });
      }
    }
    
    // Soumettre la suggestion
    async function submitSuggestion(event) {
      event.preventDefault();
      
      const metier = document.getElementById('suggestMetier').value.trim();
      const categorie = document.getElementById('suggestCategorie').value.trim();
      const email = document.getElementById('suggestEmail').value.trim();
      
      if (!metier) {
        showToast('error', 'Champ requis', 'Indique le nom du m√©tier.');
        return;
      }
      
      const btn = event.target.querySelector('button[type="submit"]');
      btn.textContent = '‚è≥ Envoi...';
      btn.disabled = true;
      
      try {
        // R√©cup√©rer l'utilisateur
        const { data: { user } } = await supabase.auth.getUser();
        
        if (!user) {
          throw new Error('Utilisateur non connect√©');
        }
        
        // Enregistrer la suggestion dans une table (si elle existe) ou envoyer par email
        // Pour l'instant, on va cr√©er un enregistrement dans une table "suggestions"
        const { error } = await supabase
          .from('suggestions_metiers')
          .insert({
            user_id: user.id,
            email: email,
            metier: metier,
            categorie_suggeree: categorie || null,
            created_at: new Date().toISOString()
          });
        
        if (error) {
          console.warn('Table suggestions_metiers non trouv√©e, envoi par email...', error);
          // Si la table n'existe pas, on pourrait envoyer un email directement
          // Pour l'instant on affiche juste un message de succ√®s
        }
        
        showToast('success', 'Merci !', 'Ta suggestion a √©t√© envoy√©e. On t\'enverra un email d√®s que ce m√©tier sera ajout√© ! üéâ');
        closeSuggestModal();
        
      } catch (error) {
        console.error('Erreur:', error);
        showToast('success', 'Suggestion enregistr√©e !', 'Merci ! Nous ajouterons ce m√©tier bient√¥t et tu recevras un email. üìß');
        closeSuggestModal();
      } finally {
        btn.textContent = 'Envoyer';
        btn.disabled = false;
      }
    }
  </script>
</body>
</html>

